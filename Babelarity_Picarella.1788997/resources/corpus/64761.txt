In algebra, the partial fraction decomposition or partial fraction expansion of a rational function (that is a fraction such that the numerator and the denominator are both polynomials) is the operation that consists in expressing the fraction as a sum of a polynomial (possibly zero) and one or several fractions with a simpler denominator.
The importance of the partial fraction decomposition lies in the fact that it provides an algorithm for computing the antiderivative of a rational function.
In symbols, one can use partial fraction expansion to change a rational fraction in the form
              f
              (
              x
              )
              g
              (
              x
              )
    {\displaystyle {\frac {f(x)}{g(x)}}}
where ƒ and g are polynomials, into an expression of the form
          ∑
            j
                f
                  j
              (
              x
              )
                g
                  j
              (
              x
              )
    {\displaystyle \sum _{j}{\frac {f_{j}(x)}{g_{j}(x)}}}
where gj (x) are polynomials that are factors of g(x), and are in general of lower degree. Thus, the partial fraction decomposition may be seen as the inverse procedure of the more elementary operation of addition of rational fractions, which produces a single rational fraction with a numerator and denominator usually of high degree. The full decomposition pushes the reduction as far as it can go: in other words, the factorization of g is used as much as possible. Thus, the outcome of a full partial fraction expansion expresses that fraction as a sum of a polynomial and one of several fractions, such that:
the denominator of each fraction is a power of an irreducible (not factorable) polynomial and
the numerator is a polynomial of smaller degree than this irreducible polynomial.
As factorization of polynomials may be difficult, a coarser decomposition is often preferred, which consists of replacing factorization by square-free factorization. This amounts to replace "irreducible" by "square-free" in the preceding description of the outcome.
Assume a rational function 
        R
        (
        x
        )
        =
              f
              (
              x
              )
              g
              (
              x
              )
    {\displaystyle R(x)={\frac {f(x)}{g(x)}}}
   in one indeterminate x has a denominator that factors as
        g
        (
        x
        )
        =
        P
        (
        x
        )
        ⋅
        Q
        (
        x
        )
    {\displaystyle g(x)=P(x)\cdot Q(x)\,}
over a field K (we can take this to be real numbers, or complex numbers). Assume further that P and Q have no common factor. By Bézout's identity for polynomials, there exist polynomials C(x) and D(x) such that
        C
        P
        +
        D
        Q
        =
        1
    {\displaystyle CP+DQ=1}
Thus 
            1
              g
              (
              x
              )
        =
              C
              P
              +
              D
              Q
              P
              Q
        =
            C
            Q
        +
            D
            P
    {\displaystyle {\frac {1}{g(x)}}={\frac {CP+DQ}{PQ}}={\frac {C}{Q}}+{\frac {D}{P}}}
   and hence R may be written as
        R
        =
              f
              (
              x
              )
              g
              (
              x
              )
        =
              D
              f
              (
              x
              )
            P
        +
              C
              f
              (
              x
              )
            Q
        ,
    {\displaystyle R={\frac {f(x)}{g(x)}}={\frac {Df(x)}{P}}+{\frac {Cf(x)}{Q}},}
where all numerators are polynomials.
Using this idea inductively we can write R(x) as a sum with denominators powers of irreducible polynomials. To take this further, if required, write:
              G
              (
              x
              )
              F
              (
              x
                )
                  n
    {\displaystyle {\frac {G(x)}{F(x)^{n}}}}
as a sum with denominators powers of F and numerators of degree less than F, plus a possible extra polynomial. This can be done by the Euclidean algorithm, polynomial case. The result is the following theorem:
Therefore, when the field K is the complex numbers, we can assume that each pi has degree 1 (by the fundamental theorem of algebra) the numerators will be constant. When K is the real numbers, some of the pi might be quadratic, so, in the partial fraction decomposition, a quotient of a linear polynomial by a power of a quadratic might occur.
In the preceding theorem, one may replace "distinct irreducible polynomials" by "pairwise coprime polynomials that are coprime with their derivative". For example, the pi may be the factors of the square-free factorization of g. When K is the field of the rational numbers, as it is typically the case in computer algebra, this allows to replace factorization by greatest common divisor to compute the partial fraction decomposition.
For the purpose of symbolic integration, the preceding result may be refined into
This reduces the computation of the antiderivative of a rational function to the integration of the last sum, which is called the logarithmic part, because its antiderivative is a linear combination of logarithms. In fact, we have
              c
                i
                1
              p
                i
        =
          ∑
              α
                j
            :
              p
                i
            (
              α
                j
            )
            =
            0
                c
                  i
                  1
              (
                α
                  j
              )
                p
                  i
                ′
              (
                α
                  j
              )
            1
              x
              −
                α
                  j
        .
    {\displaystyle {\frac {c_{i1}}{p_{i}}}=\sum _{\alpha _{j}:p_{i}(\alpha _{j})=0}{\frac {c_{i1}(\alpha _{j})}{p'_{i}(\alpha _{j})}}{\frac {1}{x-\alpha _{j}}}.}
There are various methods to compute above decomposition. The one that is the simplest to describe is probably the so-called Hermite's method. As the degree of cij is bounded by the degree of pi, and the degree of b is the difference of the degrees of f and g (if this difference is non negative; otherwise, b=0), one may write these unknowns polynomials as polynomials with unknown coefficients. Reducing the two members of above formula to the same denominator and writing that the coefficients of each power of x are the same in the two numerators, one gets a system of linear equations which can be solved to obtain the desired values for the unknowns coefficients.
Given two polynomials 
        P
        (
        x
        )
    {\displaystyle P(x)}
   and 
        Q
        (
        x
        )
        =
        (
        x
        −
          α
            1
        )
        (
        x
        −
          α
            2
        )
        ⋯
        (
        x
        −
          α
            n
        )
    {\displaystyle Q(x)=(x-\alpha _{1})(x-\alpha _{2})\cdots (x-\alpha _{n})}
  , where the αi are distinct constants and deg P < n, partial fractions are generally obtained by supposing that
              P
              (
              x
              )
              Q
              (
              x
              )
        =
              c
                1
              x
              −
                α
                  1
        +
              c
                2
              x
              −
                α
                  2
        +
        ⋯
        +
              c
                n
              x
              −
                α
                  n
    {\displaystyle {\frac {P(x)}{Q(x)}}={\frac {c_{1}}{x-\alpha _{1}}}+{\frac {c_{2}}{x-\alpha _{2}}}+\cdots +{\frac {c_{n}}{x-\alpha _{n}}}}
and solving for the ci constants, by substitution, by equating the coefficients of terms involving the powers of x, or otherwise. (This is a variant of the method of undetermined coefficients.)
A more direct computation, which is strongly related with Lagrange interpolation consists of writing
              P
              (
              x
              )
              Q
              (
              x
              )
        =
          ∑
            i
            =
            1
            n
              P
              (
                α
                  i
              )
                Q
                ′
              (
                α
                  i
              )
            1
              (
              x
              −
                α
                  i
              )
    {\displaystyle {\frac {P(x)}{Q(x)}}=\sum _{i=1}^{n}{\frac {P(\alpha _{i})}{Q'(\alpha _{i})}}{\frac {1}{(x-\alpha _{i})}}}
where 
          Q
          ′
    {\displaystyle Q'}
   is the derivative of the polynomial 
        Q
    {\displaystyle Q}
  .
This approach does not account for several other cases, but can be modified accordingly:
If deg P  
        ≥
    {\displaystyle \geq }
    deg Q, then it is necessary to perform the Euclidean division of P by Q, using polynomial long division, giving P(x) = E(x) Q(x) + R(x) with deg R < n. Dividing by Q(x) this gives
              P
              (
              x
              )
              Q
              (
              x
              )
        =
        E
        (
        x
        )
        +
              R
              (
              x
              )
              Q
              (
              x
              )
        ,
    {\displaystyle {\frac {P(x)}{Q(x)}}=E(x)+{\frac {R(x)}{Q(x)}},}
and then seek partial fractions for the remainder fraction (which by definition satisfies deg R < deg Q).
If Q(x) contains factors which are irreducible over the given field, then the numerator N(x) of each partial fraction with such a factor F(x) in the denominator must be sought as a polynomial with deg N < deg F, rather than as a constant. For example, take the following decomposition over R:
                x
                  2
              +
              1
              (
              x
              +
              2
              )
              (
              x
              −
              1
              )
                (
                  x
                    2
                +
                x
                +
                1
                )
        =
            a
              x
              +
              2
        +
            b
              x
              −
              1
        +
              c
              x
              +
              d
                x
                  2
              +
              x
              +
              1
        .
    {\displaystyle {\frac {x^{2}+1}{(x+2)(x-1)\color {Blue}(x^{2}+x+1)}}={\frac {a}{x+2}}+{\frac {b}{x-1}}+{\frac {\color {OliveGreen}cx+d}{\color {Blue}x^{2}+x+1}}.}
Suppose Q(x) = (x − α)rS(x) and S(α) ≠ 0. Then Q(x) has a zero α of multiplicity r, and in the partial fraction decomposition, r of the partial fractions will involve the powers of (x − α). For illustration, take S(x) = 1 to get the following decomposition:
              P
              (
              x
              )
              Q
              (
              x
              )
        =
              P
              (
              x
              )
              (
              x
              −
              α
                )
                  r
        =
              c
                1
              x
              −
              α
        +
              c
                2
              (
              x
              −
              α
                )
                  2
        +
        ⋯
        +
              c
                r
              (
              x
              −
              α
                )
                  r
        .
    {\displaystyle {\frac {P(x)}{Q(x)}}={\frac {P(x)}{(x-\alpha )^{r}}}={\frac {c_{1}}{x-\alpha }}+{\frac {c_{2}}{(x-\alpha )^{2}}}+\cdots +{\frac {c_{r}}{(x-\alpha )^{r}}}.}
In an example application of this procedure, (3x + 5)/(1 − 2x)2 can be decomposed in the form
              3
              x
              +
              5
              (
              1
              −
              2
              x
                )
                  2
        =
            A
              (
              1
              −
              2
              x
                )
                  2
        +
            B
              (
              1
              −
              2
              x
              )
        .
    {\displaystyle {\frac {3x+5}{(1-2x)^{2}}}={\frac {A}{(1-2x)^{2}}}+{\frac {B}{(1-2x)}}.}
Clearing denominators shows that 3x + 5 = A + B(1 − 2x). Expanding and equating the coefficients of powers of x gives
5 = A + B and 3x = −2Bx
Solving for A and B yields A = 13/2 and B = −3/2. Hence,
              3
              x
              +
              5
              (
              1
              −
              2
              x
                )
                  2
        =
              13
                /
              2
              (
              1
              −
              2
              x
                )
                  2
        +
              −
              3
                /
              2
              (
              1
              −
              2
              x
              )
        .
    {\displaystyle {\frac {3x+5}{(1-2x)^{2}}}={\frac {13/2}{(1-2x)^{2}}}+{\frac {-3/2}{(1-2x)}}.}
Over the complex numbers, suppose ƒ(x) is a rational proper fraction, and can be decomposed into
        f
        (
        x
        )
        =
          ∑
            i
          (
                a
                  i
                  1
                x
                −
                  x
                    i
          +
                a
                  i
                  2
                (
                x
                −
                  x
                    i
                  )
                    2
          +
          ⋯
          +
                a
                  i
                    k
                      i
                (
                x
                −
                  x
                    i
                  )
                      k
                        i
          )
        .
    {\displaystyle f(x)=\sum _{i}\left({\frac {a_{i1}}{x-x_{i}}}+{\frac {a_{i2}}{(x-x_{i})^{2}}}+\cdots +{\frac {a_{ik_{i}}}{(x-x_{i})^{k_{i}}}}\right).}
Let
          g
            i
            j
        (
        x
        )
        =
        (
        x
        −
          x
            i
          )
            j
            −
            1
        f
        (
        x
        )
        ,
    {\displaystyle g_{ij}(x)=(x-x_{i})^{j-1}f(x),}
then according to the uniqueness of Laurent series, aij is the coefficient of the term (x − xi)−1 in the Laurent expansion of gij(x) about the point xi, i.e., its residue
          a
            i
            j
        =
        Res
        ⁡
        (
          g
            i
            j
        ,
          x
            i
        )
        .
    {\displaystyle a_{ij}=\operatorname {Res} (g_{ij},x_{i}).}
This is given directly by the formula
          a
            i
            j
        =
            1
              (
                k
                  i
              −
              j
              )
              !
          lim
            x
            →
              x
                i
              d
                  k
                    i
                −
                j
              d
                x
                    k
                      i
                  −
                  j
          (
          (
          x
          −
            x
              i
            )
                k
                  i
          f
          (
          x
          )
          )
        ,
    {\displaystyle a_{ij}={\frac {1}{(k_{i}-j)!}}\lim _{x\to x_{i}}{\frac {d^{k_{i}-j}}{dx^{k_{i}-j}}}\left((x-x_{i})^{k_{i}}f(x)\right),}
or in the special case when xi is a simple root,
          a
            i
            1
        =
              P
              (
                x
                  i
              )
                Q
                ′
              (
                x
                  i
              )
        ,
    {\displaystyle a_{i1}={\frac {P(x_{i})}{Q'(x_{i})}},}
when
        f
        (
        x
        )
        =
              P
              (
              x
              )
              Q
              (
              x
              )
        .
    {\displaystyle f(x)={\frac {P(x)}{Q(x)}}.}
Note that P(x) and Q(x) may or may not be polynomials.
Partial fractions are used in real-variable integral calculus to find real-valued antiderivatives of rational functions. Partial fraction decomposition of real rational functions is also used to find their Inverse Laplace transforms. For applications of partial fraction decomposition over the reals, see
Application to symbolic integration, above
Partial fractions in Laplace transforms
Let ƒ(x) be any rational function over the real numbers. In other words, suppose there exist real polynomials functions p(x) and q(x)≠ 0, such that
        f
        (
        x
        )
        =
              p
              (
              x
              )
              q
              (
              x
              )
    {\displaystyle f(x)={\frac {p(x)}{q(x)}}}
By dividing both the numerator and the denominator by the leading coefficient of q(x), we may assume without loss of generality that q(x) is monic. By the fundamental theorem of algebra, we can write
        q
        (
        x
        )
        =
        (
        x
        −
          a
            1
          )
              j
                1
        ⋯
        (
        x
        −
          a
            m
          )
              j
                m
        (
          x
            2
        +
          b
            1
        x
        +
          c
            1
          )
              k
                1
        ⋯
        (
          x
            2
        +
          b
            n
        x
        +
          c
            n
          )
              k
                n
    {\displaystyle q(x)=(x-a_{1})^{j_{1}}\cdots (x-a_{m})^{j_{m}}(x^{2}+b_{1}x+c_{1})^{k_{1}}\cdots (x^{2}+b_{n}x+c_{n})^{k_{n}}}
where a1,..., am, b1,..., bn, c1,..., cn are real numbers with bi2 − 4ci < 0, and j1,..., jm, k1,..., kn are positive integers. The terms (x − ai) are the linear factors of q(x) which correspond to real roots of q(x), and the terms (xi2 + bix + ci) are the irreducible quadratic factors of q(x) which correspond to pairs of complex conjugate roots of q(x).
Then the partial fraction decomposition of ƒ(x) is the following:
        f
        (
        x
        )
        =
              p
              (
              x
              )
              q
              (
              x
              )
        =
        P
        (
        x
        )
        +
          ∑
            i
            =
            1
            m
          ∑
            r
            =
            1
              j
                i
              A
                i
                r
              (
              x
              −
                a
                  i
                )
                  r
        +
          ∑
            i
            =
            1
            n
          ∑
            r
            =
            1
              k
                i
                B
                  i
                  r
              x
              +
                C
                  i
                  r
              (
                x
                  2
              +
                b
                  i
              x
              +
                c
                  i
                )
                  r
    {\displaystyle f(x)={\frac {p(x)}{q(x)}}=P(x)+\sum _{i=1}^{m}\sum _{r=1}^{j_{i}}{\frac {A_{ir}}{(x-a_{i})^{r}}}+\sum _{i=1}^{n}\sum _{r=1}^{k_{i}}{\frac {B_{ir}x+C_{ir}}{(x^{2}+b_{i}x+c_{i})^{r}}}}
Here, P(x) is a (possibly zero) polynomial, and the Air, Bir, and Cir are real constants. There are a number of ways the constants can be found.
The most straightforward method is to multiply through by the common denominator q(x). We then obtain an equation of polynomials whose left-hand side is simply p(x) and whose right-hand side has coefficients which are linear expressions of the constants Air, Bir, and Cir. Since two polynomials are equal if and only if their corresponding coefficients are equal, we can equate the coefficients of like terms. In this way, a system of linear equations is obtained which always has a unique solution. This solution can be found using any of the standard methods of linear algebra. It can also be found with limits (see Example 5).
        f
        (
        x
        )
        =
            1
                x
                  2
              +
              2
              x
              −
              3
    {\displaystyle f(x)={\frac {1}{x^{2}+2x-3}}}
Here, the denominator splits into two distinct linear factors:
        q
        (
        x
        )
        =
          x
            2
        +
        2
        x
        −
        3
        =
        (
        x
        +
        3
        )
        (
        x
        −
        1
        )
    {\displaystyle q(x)=x^{2}+2x-3=(x+3)(x-1)}
so we have the partial fraction decomposition
        f
        (
        x
        )
        =
            1
                x
                  2
              +
              2
              x
              −
              3
        =
            A
              x
              +
              3
        +
            B
              x
              −
              1
    {\displaystyle f(x)={\frac {1}{x^{2}+2x-3}}={\frac {A}{x+3}}+{\frac {B}{x-1}}}
Multiplying through by the denominator on the left-hand side gives us the polynomial identity
        1
        =
        A
        (
        x
        −
        1
        )
        +
        B
        (
        x
        +
        3
        )
    {\displaystyle 1=A(x-1)+B(x+3)}
Substituting x = −3 into this equation gives A = −1/4, and substituting x = 1 gives B = 1/4, so that
        f
        (
        x
        )
        =
            1
                x
                  2
              +
              2
              x
              −
              3
        =
            1
            4
          (
                −
                1
                x
                +
                3
          +
              1
                x
                −
                1
          )
    {\displaystyle f(x)={\frac {1}{x^{2}+2x-3}}={\frac {1}{4}}\left({\frac {-1}{x+3}}+{\frac {1}{x-1}}\right)}
        f
        (
        x
        )
        =
                x
                  3
              +
              16
                x
                  3
              −
              4
                x
                  2
              +
              8
              x
    {\displaystyle f(x)={\frac {x^{3}+16}{x^{3}-4x^{2}+8x}}}
After long-division, we have
        f
        (
        x
        )
        =
        1
        +
              4
                x
                  2
              −
              8
              x
              +
              16
                x
                  3
              −
              4
                x
                  2
              +
              8
              x
        =
        1
        +
              4
                x
                  2
              −
              8
              x
              +
              16
              x
              (
                x
                  2
              −
              4
              x
              +
              8
              )
    {\displaystyle f(x)=1+{\frac {4x^{2}-8x+16}{x^{3}-4x^{2}+8x}}=1+{\frac {4x^{2}-8x+16}{x(x^{2}-4x+8)}}}
Since (−4)2 − 4×8 = −16 < 0, the factor x2 − 4x + 8 is irreducible, and the partial fraction decomposition over the reals has the shape
              4
                x
                  2
              −
              8
              x
              +
              16
              x
              (
                x
                  2
              −
              4
              x
              +
              8
              )
        =
            A
            x
        +
              B
              x
              +
              C
                x
                  2
              −
              4
              x
              +
              8
    {\displaystyle {\frac {4x^{2}-8x+16}{x(x^{2}-4x+8)}}={\frac {A}{x}}+{\frac {Bx+C}{x^{2}-4x+8}}}
Multiplying through by x3 − 4x2 + 8x, we have the polynomial identity
        4
          x
            2
        −
        8
        x
        +
        16
        =
        A
        (
          x
            2
        −
        4
        x
        +
        8
        )
        +
        (
        B
        x
        +
        C
        )
        x
    {\displaystyle 4x^{2}-8x+16=A(x^{2}-4x+8)+(Bx+C)x}
Taking x = 0, we see that 16 = 8A, so A = 2. Comparing the x2 coefficients, we see that 4 = A + B = 2 + B, so B = 2. Comparing linear coefficients, we see that −8 = −4A + C = −8 + C, so C = 0. Altogether,
        f
        (
        x
        )
        =
        1
        +
        2
          (
              1
              x
          +
              x
                  x
                    2
                −
                4
                x
                +
                8
          )
    {\displaystyle f(x)=1+2\left({\frac {1}{x}}+{\frac {x}{x^{2}-4x+8}}\right)}
If you wish, you can decompose it completely. In that case we must go over to the complex numbers. According to the Fundamental theorem of algebra every complex polynomial of degree n has n (complex) roots (some of which can be repeated), focusing on the second fraction we decompose it to:
            x
                x
                  2
              −
              4
              x
              +
              8
        =
            D
              x
              −
              (
              2
              +
              2
              i
              )
        +
            E
              x
              −
              (
              2
              −
              2
              i
              )
    {\displaystyle {\frac {x}{x^{2}-4x+8}}={\frac {D}{x-(2+2i)}}+{\frac {E}{x-(2-2i)}}}
Multiplying through by the denominator gives:
        x
        =
        D
        (
        x
        −
        (
        2
        −
        2
        i
        )
        )
        +
        E
        (
        x
        −
        (
        2
        +
        2
        i
        )
        )
    {\displaystyle x=D(x-(2-2i))+E(x-(2+2i))}
So,
        D
        =
              1
              +
              i
              2
              i
        =
              1
              −
              i
            2
        ,
        E
        =
              1
              −
              i
              −
              2
              i
        =
              1
              +
              i
            2
    {\displaystyle D={\frac {1+i}{2i}}={\frac {1-i}{2}},\qquad E={\frac {1-i}{-2i}}={\frac {1+i}{2}}}
and thus we have a complete decomposition:
        f
        (
        x
        )
        =
                x
                  3
              +
              16
                x
                  3
              −
              4
                x
                  2
              +
              8
              x
        =
        1
        +
            2
            x
        +
              1
              −
              i
              x
              −
              (
              2
              +
              2
              i
              )
        +
              1
              +
              i
              x
              −
              (
              2
              −
              2
              i
              )
    {\displaystyle f(x)={\frac {x^{3}+16}{x^{3}-4x^{2}+8x}}=1+{\frac {2}{x}}+{\frac {1-i}{x-(2+2i)}}+{\frac {1+i}{x-(2-2i)}}}
This example illustrates almost all the "tricks" we might need to use, short of consulting a computer algebra system.
        f
        (
        x
        )
        =
                x
                  9
              −
              2
                x
                  6
              +
              2
                x
                  5
              −
              7
                x
                  4
              +
              13
                x
                  3
              −
              11
                x
                  2
              +
              12
              x
              −
              4
                x
                  7
              −
              3
                x
                  6
              +
              5
                x
                  5
              −
              7
                x
                  4
              +
              7
                x
                  3
              −
              5
                x
                  2
              +
              3
              x
              −
              1
    {\displaystyle f(x)={\frac {x^{9}-2x^{6}+2x^{5}-7x^{4}+13x^{3}-11x^{2}+12x-4}{x^{7}-3x^{6}+5x^{5}-7x^{4}+7x^{3}-5x^{2}+3x-1}}}
After long-division and factoring the denominator, we have
        f
        (
        x
        )
        =
          x
            2
        +
        3
        x
        +
        4
        +
              2
                x
                  6
              −
              4
                x
                  5
              +
              5
                x
                  4
              −
              3
                x
                  3
              +
                x
                  2
              +
              3
              x
              (
              x
              −
              1
                )
                  3
              (
                x
                  2
              +
              1
                )
                  2
    {\displaystyle f(x)=x^{2}+3x+4+{\frac {2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x}{(x-1)^{3}(x^{2}+1)^{2}}}}
The partial fraction decomposition takes the form
              2
                x
                  6
              −
              4
                x
                  5
              +
              5
                x
                  4
              −
              3
                x
                  3
              +
                x
                  2
              +
              3
              x
              (
              x
              −
              1
                )
                  3
              (
                x
                  2
              +
              1
                )
                  2
        =
            A
              x
              −
              1
        +
            B
              (
              x
              −
              1
                )
                  2
        +
            C
              (
              x
              −
              1
                )
                  3
        +
              D
              x
              +
              E
                x
                  2
              +
              1
        +
              F
              x
              +
              G
              (
                x
                  2
              +
              1
                )
                  2
    {\displaystyle {\frac {2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x}{(x-1)^{3}(x^{2}+1)^{2}}}={\frac {A}{x-1}}+{\frac {B}{(x-1)^{2}}}+{\frac {C}{(x-1)^{3}}}+{\frac {Dx+E}{x^{2}+1}}+{\frac {Fx+G}{(x^{2}+1)^{2}}}}
Multiplying through by the denominator on the left-hand side we have the polynomial identity
                2
                  x
                    6
                −
                4
                  x
                    5
                +
                5
                  x
                    4
                −
                3
                  x
                    3
                +
                  x
                    2
                +
                3
                x
                =
                =
                A
                (
                x
                −
                1
                  )
                    2
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                B
                (
                x
                −
                1
                )
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                C
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                (
                D
                x
                +
                E
                )
                (
                x
                −
                1
                  )
                    3
                (
                  x
                    2
                +
                1
                )
                +
                (
                F
                x
                +
                G
                )
                (
                x
                −
                1
                  )
                    3
    {\displaystyle {\begin{aligned}&2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x=\\&\qquad =A(x-1)^{2}(x^{2}+1)^{2}+B(x-1)(x^{2}+1)^{2}+C(x^{2}+1)^{2}+(Dx+E)(x-1)^{3}(x^{2}+1)+(Fx+G)(x-1)^{3}\end{aligned}}}
Now we use different values of x to compute the coefficients:
            {
                  4
                  =
                  4
                  C
                  x
                  =
                  1
                  2
                  +
                  2
                  ı
                  =
                  (
                  F
                  ı
                  +
                  G
                  )
                  (
                  2
                  +
                  2
                  ı
                  )
                  x
                  =
                  ı
                  0
                  =
                  A
                  −
                  B
                  +
                  C
                  −
                  E
                  −
                  G
                  x
                  =
                  0
    {\displaystyle {\begin{cases}4=4C&x=1\\2+2\imath =(F\imath +G)(2+2\imath )&x=\imath \\0=A-B+C-E-G&x=0\end{cases}}}
Solving this we have:
            {
                  C
                  =
                  1
                  F
                  =
                  0
                  ,
                  G
                  =
                  1
                  E
                  =
                  A
                  −
                  B
    {\displaystyle {\begin{cases}C=1\\F=0,G=1\\E=A-B\end{cases}}}
We using these values we can write:
                2
                  x
                    6
                −
                4
                  x
                    5
                +
                5
                  x
                    4
                −
                3
                  x
                    3
                +
                  x
                    2
                +
                3
                x
                =
                =
                A
                (
                x
                −
                1
                  )
                    2
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                B
                (
                x
                −
                1
                )
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                (
                  x
                    2
                +
                1
                  )
                    2
                +
                (
                D
                x
                +
                (
                A
                −
                B
                )
                )
                (
                x
                −
                1
                  )
                    3
                (
                  x
                    2
                +
                1
                )
                +
                (
                x
                −
                1
                  )
                    3
                =
                (
                A
                +
                D
                )
                  x
                    6
                +
                (
                −
                A
                −
                3
                D
                )
                  x
                    5
                +
                (
                2
                B
                +
                4
                D
                +
                1
                )
                  x
                    4
                +
                (
                −
                2
                B
                −
                4
                D
                +
                1
                )
                  x
                    3
                +
                (
                −
                A
                +
                2
                B
                +
                3
                D
                −
                1
                )
                  x
                    2
                +
                (
                A
                −
                2
                B
                −
                D
                +
                3
                )
                x
    {\displaystyle {\begin{aligned}&2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x=\\&\qquad =A(x-1)^{2}(x^{2}+1)^{2}+B(x-1)(x^{2}+1)^{2}+(x^{2}+1)^{2}+(Dx+(A-B))(x-1)^{3}(x^{2}+1)+(x-1)^{3}\\&\qquad =(A+D)x^{6}+(-A-3D)x^{5}+(2B+4D+1)x^{4}+(-2B-4D+1)x^{3}+(-A+2B+3D-1)x^{2}+(A-2B-D+3)x\end{aligned}}}
We compare the coefficients of x6 and x5 on both side and we have:
            {
                  A
                  +
                  D
                  =
                  2
                  −
                  A
                  −
                  3
                  D
                  =
                  −
                  4
        ⇒
        A
        =
        D
        =
        1.
    {\displaystyle {\begin{cases}A+D=2\\-A-3D=-4\end{cases}}\quad \Rightarrow \quad A=D=1.}
Therefore:
        2
          x
            6
        −
        4
          x
            5
        +
        5
          x
            4
        −
        3
          x
            3
        +
          x
            2
        +
        3
        x
        =
        2
          x
            6
        −
        4
          x
            5
        +
        (
        2
        B
        +
        5
        )
          x
            4
        +
        (
        −
        2
        B
        −
        3
        )
          x
            3
        +
        (
        2
        B
        +
        1
        )
          x
            2
        +
        (
        −
        2
        B
        +
        3
        )
        x
    {\displaystyle 2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x=2x^{6}-4x^{5}+(2B+5)x^{4}+(-2B-3)x^{3}+(2B+1)x^{2}+(-2B+3)x}
which gives us B = 0. Thus the partial fraction decomposition of f(x) is thus
        f
        (
        x
        )
        =
          x
            2
        +
        3
        x
        +
        4
        +
            1
              (
              x
              −
              1
              )
        +
            1
              (
              x
              −
              1
                )
                  3
        +
              x
              +
              1
                x
                  2
              +
              1
        +
            1
              (
                x
                  2
              +
              1
                )
                  2
        .
    {\displaystyle f(x)=x^{2}+3x+4+{\frac {1}{(x-1)}}+{\frac {1}{(x-1)^{3}}}+{\frac {x+1}{x^{2}+1}}+{\frac {1}{(x^{2}+1)^{2}}}.}
Alternatively, instead of expanding, one can obtain other linear dependences on the coefficients computing some derivatives at 
        x
        =
        1
        ,
        ı
    {\displaystyle x=1,\imath }
   in the above polynomial identity. (To this end, recall that the derivative at x = a of (x − a)mp(x) vanishes if m > 1 and is just p(a) for m = 1.) For instance the first derivative at x = 1 gives
        2
        ⋅
        6
        −
        4
        ⋅
        5
        +
        5
        ⋅
        4
        −
        3
        ⋅
        3
        +
        2
        +
        3
        =
        A
        ⋅
        (
        0
        +
        0
        )
        +
        B
        ⋅
        (
        4
        +
        0
        )
        +
        8
        +
        D
        ⋅
        0
    {\displaystyle 2\cdot 6-4\cdot 5+5\cdot 4-3\cdot 3+2+3=A\cdot (0+0)+B\cdot (4+0)+8+D\cdot 0}
that is 8 = 4B + 8 so B = 0.
        f
        (
        z
        )
        =
                z
                  2
              −
              5
              (
                z
                  2
              −
              1
              )
              (
                z
                  2
              +
              1
              )
        =
                z
                  2
              −
              5
              (
              z
              +
              1
              )
              (
              z
              −
              1
              )
              (
              z
              +
              i
              )
              (
              z
              −
              i
              )
    {\displaystyle f(z)={\frac {z^{2}-5}{(z^{2}-1)(z^{2}+1)}}={\frac {z^{2}-5}{(z+1)(z-1)(z+i)(z-i)}}}
Thus, f(z) can be decomposed into rational functions whose denominators are z+1, z−1, z+i, z−i. Since each term is of power one, −1, 1, −i and i are simple poles.
Hence, the residues associated with each pole, given by
              P
              (
                z
                  i
              )
                Q
                ′
              (
                z
                  i
              )
        =
                z
                  i
                  2
              −
              5
              4
                z
                  i
                  3
    {\displaystyle {\frac {P(z_{i})}{Q'(z_{i})}}={\frac {z_{i}^{2}-5}{4z_{i}^{3}}}}
  ,
are
        1
        ,
        −
        1
        ,
                3
                i
              2
        ,
        −
                3
                i
              2
    {\displaystyle 1,-1,{\tfrac {3i}{2}},-{\tfrac {3i}{2}}}
  ,
respectively, and
        f
        (
        z
        )
        =
            1
              z
              +
              1
        −
            1
              z
              −
              1
        +
              3
              i
            2
            1
              z
              +
              i
        −
              3
              i
            2
            1
              z
              −
              i
    {\displaystyle f(z)={\frac {1}{z+1}}-{\frac {1}{z-1}}+{\frac {3i}{2}}{\frac {1}{z+i}}-{\frac {3i}{2}}{\frac {1}{z-i}}}
  .
Limits can be used to find a partial fraction decomposition. Consider the following example:
            1
                x
                  3
              −
              1
    {\displaystyle {\frac {1}{x^{3}-1}}}
First, factor the denominator which determines the decomposition:
            1
                x
                  3
              −
              1
        =
            1
              (
              x
              −
              1
              )
              (
                x
                  2
              +
              x
              +
              1
              )
        =
            A
              x
              −
              1
        +
              B
              x
              +
              C
                x
                  2
              +
              x
              +
              1
        .
    {\displaystyle {\frac {1}{x^{3}-1}}={\frac {1}{(x-1)(x^{2}+x+1)}}={\frac {A}{x-1}}+{\frac {Bx+C}{x^{2}+x+1}}.}
As 
        x
        →
        1
    {\displaystyle x\to 1}
  , we first observe that:
          lim
            x
            →
            1
          (
              A
                x
                −
                1
          +
                B
                x
                +
                C
                  x
                    2
                +
                x
                +
                1
          )
        =
          lim
            x
            →
            1
            A
              x
              −
              1
        .
    {\displaystyle \lim _{x\to 1}\left({\frac {A}{x-1}}+{\frac {Bx+C}{x^{2}+x+1}}\right)=\lim _{x\to 1}{\frac {A}{x-1}}.}
Therefore:
          lim
            x
            →
            1
            1
              (
              x
              −
              1
              )
              (
                x
                  2
              +
              x
              +
              1
              )
        =
          lim
            x
            →
            1
            A
              x
              −
              1
        ,
    {\displaystyle \lim _{x\to 1}{\frac {1}{(x-1)(x^{2}+x+1)}}=\lim _{x\to 1}{\frac {A}{x-1}},}
and thus:
        A
        =
          lim
            x
            →
            1
            1
                x
                  2
              +
              x
              +
              1
        =
            1
            3
    {\displaystyle A=\lim _{x\to 1}{\frac {1}{x^{2}+x+1}}={\frac {1}{3}}}
As 
        x
        →
        ∞
    {\displaystyle x\to \infty }
  , we note that:
          lim
            x
            →
            ∞
          (
              A
                x
                −
                1
          +
                B
                x
                +
                C
                  x
                    2
                +
                x
                +
                1
          )
        =
          lim
            x
            →
            ∞
          (
              A
              x
          +
                B
                x
                x
                  2
          )
        =
          lim
            x
            →
            ∞
              A
              +
              B
            x
        .
    {\displaystyle \lim _{x\to \infty }\left({\frac {A}{x-1}}+{\frac {Bx+C}{x^{2}+x+1}}\right)=\lim _{x\to \infty }\left({\frac {A}{x}}+{\frac {Bx}{x^{2}}}\right)=\lim _{x\to \infty }{\frac {A+B}{x}}.}
Therefore:
          lim
            x
            →
            ∞
              A
              +
              B
            x
        =
          lim
            x
            →
            ∞
            1
              (
              x
              −
              1
              )
              (
                x
                  2
              +
              x
              +
              1
              )
        =
        0
        ,
    {\displaystyle \lim _{x\to \infty }{\frac {A+B}{x}}=\lim _{x\to \infty }{\frac {1}{(x-1)(x^{2}+x+1)}}=0,}
which implies A + B = 0 and so 
        B
        =
        −
              1
              3
    {\displaystyle B=-{\tfrac {1}{3}}}
  .
At 
        x
        =
        0
        ,
        −
        1
        =
        −
        A
        +
        C
    {\displaystyle x=0,-1=-A+C}
  . Therefore, 
        C
        =
        −
              2
              3
    {\displaystyle C=-{\tfrac {2}{3}}}
  .
The decomposition is:
            1
                x
                  3
              −
              1
        =
            1
            3
          (
              1
                x
                −
                1
          +
                −
                x
                −
                2
                  x
                    2
                +
                x
                +
                1
          )
        .
    {\displaystyle {\frac {1}{x^{3}-1}}={\frac {1}{3}}\left({\frac {1}{x-1}}+{\frac {-x-2}{x^{2}+x+1}}\right).}
The partial fraction decomposition of a rational function can be related to Taylor's theorem as follows. Let
        P
        (
        x
        )
        ,
        Q
        (
        x
        )
        ,
          A
            1
        (
        x
        )
        ,
        ⋯
        ,
          A
            r
        (
        x
        )
    {\displaystyle P(x),Q(x),A_{1}(x),\cdots ,A_{r}(x)}
be real or complex polynomials; assume that
        Q
        =
          ∏
            j
            =
            1
            r
        (
        x
        −
          λ
            j
          )
              ν
                j
        ,
    {\displaystyle Q=\prod _{j=1}^{r}(x-\lambda _{j})^{\nu _{j}},}
satisfies
        deg
        ⁡
          A
            1
        <
          ν
            1
        ,
        ⋯
        ,
        deg
        ⁡
          A
            r
        <
          ν
            r
        ,
          and
        deg
        ⁡
        (
        P
        )
        <
        deg
        ⁡
        (
        Q
        )
        =
          ∑
            j
            =
            1
            r
          ν
            j
        .
    {\displaystyle \deg A_{1}<\nu _{1},\cdots ,\deg A_{r}<\nu _{r},\quad {\text{and}}\quad \deg(P)<\deg(Q)=\sum _{j=1}^{r}\nu _{j}.}
Also define
          Q
            i
        =
          ∏
            j
            ≠
            i
        (
        x
        −
          λ
            j
          )
              ν
                j
        =
            Q
              (
              x
              −
                λ
                  i
                )
                    ν
                      i
        ,
        1
        ⩽
        i
        ⩽
        r
        .
    {\displaystyle Q_{i}=\prod _{j\neq i}(x-\lambda _{j})^{\nu _{j}}={\frac {Q}{(x-\lambda _{i})^{\nu _{i}}}},\qquad 1\leqslant i\leqslant r.}
Then we have
            P
            Q
        =
          ∑
            j
            =
            1
            r
              A
                j
              (
              x
              −
                λ
                  j
                )
                    ν
                      j
    {\displaystyle {\frac {P}{Q}}=\sum _{j=1}^{r}{\frac {A_{j}}{(x-\lambda _{j})^{\nu _{j}}}}}
if, and only if, each polynomial 
          A
            i
        (
        x
        )
    {\displaystyle A_{i}(x)}
   is the Taylor polynomial of 
              P
                Q
                  i
    {\displaystyle {\tfrac {P}{Q_{i}}}}
   of order 
          ν
            i
        −
        1
    {\displaystyle \nu _{i}-1}
   at the point 
          λ
            i
    {\displaystyle \lambda _{i}}
  :
          A
            i
        (
        x
        )
        :=
          ∑
            k
            =
            0
              ν
                i
            −
            1
            1
              k
              !
            (
                P
                  Q
                    i
            )
            (
            k
            )
        (
          λ
            i
        )
        (
        x
        −
          λ
            i
          )
            k
        .
    {\displaystyle A_{i}(x):=\sum _{k=0}^{\nu _{i}-1}{\frac {1}{k!}}\left({\frac {P}{Q_{i}}}\right)^{(k)}(\lambda _{i})\ (x-\lambda _{i})^{k}.}
Taylor's theorem (in the real or complex case) then provides a proof of the existence and uniqueness of the partial fraction decomposition, and a characterization of the coefficients.
The above partial fraction decomposition implies, for each 1 ≤ i ≤ r, a polynomial expansion
            P
              Q
                i
        =
          A
            i
        +
        O
        (
        (
        x
        −
          λ
            i
          )
              ν
                i
        )
        ,
          for 
        x
        →
          λ
            i
        ,
    {\displaystyle {\frac {P}{Q_{i}}}=A_{i}+O((x-\lambda _{i})^{\nu _{i}}),\qquad {\text{for }}x\to \lambda _{i},}
so 
          A
            i
    {\displaystyle A_{i}}
   is the Taylor polynomial of 
              P
                Q
                  i
    {\displaystyle {\tfrac {P}{Q_{i}}}}
  , because of the unicity of the polynomial expansion of order 
          ν
            i
        −
        1
    {\displaystyle \nu _{i}-1}
  , and by assumption 
        deg
        ⁡
          A
            i
        <
          ν
            i
    {\displaystyle \deg A_{i}<\nu _{i}}
  .
Conversely, if the 
          A
            i
    {\displaystyle A_{i}}
   are the Taylor polynomials, the above expansions at each 
          λ
            i
    {\displaystyle \lambda _{i}}
   hold, therefore we also have
        P
        −
          Q
            i
          A
            i
        =
        O
        (
        (
        x
        −
          λ
            i
          )
              ν
                i
        )
        ,
          for 
        x
        →
          λ
            i
        ,
    {\displaystyle P-Q_{i}A_{i}=O((x-\lambda _{i})^{\nu _{i}}),\qquad {\text{for }}x\to \lambda _{i},}
which implies that the polynomial 
        P
        −
          Q
            i
          A
            i
    {\displaystyle P-Q_{i}A_{i}}
   is divisible by 
        (
        x
        −
          λ
            i
          )
              ν
                i
        .
    {\displaystyle (x-\lambda _{i})^{\nu _{i}}.}
For 
        j
        ≠
        i
        ,
          Q
            j
          A
            j
    {\displaystyle j\neq i,Q_{j}A_{j}}
   is also divisible by 
        (
        x
        −
          λ
            i
          )
              ν
                i
    {\displaystyle (x-\lambda _{i})^{\nu _{i}}}
  , so
        P
        −
          ∑
            j
            =
            1
            r
          Q
            j
          A
            j
    {\displaystyle P-\sum _{j=1}^{r}Q_{j}A_{j}}
is divisible by 
        Q
    {\displaystyle Q}
  . Since
        deg
        ⁡
          (
          P
          −
            ∑
              j
              =
              1
              r
            Q
              j
            A
              j
          )
        <
        deg
        ⁡
        (
        Q
        )
    {\displaystyle \deg \left(P-\sum _{j=1}^{r}Q_{j}A_{j}\right)<\deg(Q)}
we then have
        P
        −
          ∑
            j
            =
            1
            r
          Q
            j
          A
            j
        =
        0
        ,
    {\displaystyle P-\sum _{j=1}^{r}Q_{j}A_{j}=0,}
and we find the partial fraction decomposition dividing by 
        Q
    {\displaystyle Q}
  .
The idea of partial fractions can be generalized to other integral domains, say the ring of integers where prime numbers take the role of irreducible denominators. For example:
            1
            18
        =
            1
            2
        −
            1
            3
        −
            1
              3
                2
        .
    {\displaystyle {\frac {1}{18}}={\frac {1}{2}}-{\frac {1}{3}}-{\frac {1}{3^{2}}}.}
