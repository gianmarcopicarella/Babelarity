In probability theory and statistics, the negative binomial distribution is a discrete probability distribution of the number of successes in a sequence of independent and identically distributed Bernoulli trials before a specified (non-random) number of failures (denoted r) occurs. For example, if we define a "1" as failure, all non-"1"s as successes, and we throw a die repeatedly until the third time “1” appears (r = three failures), then the probability distribution of the number of non-“1”s that had appeared will be a negative binomial.
The Pascal distribution (after Blaise Pascal) and Polya distribution (for George Pólya) are special cases of the negative binomial. There is a convention among engineers, climatologists, and others to reserve “negative binomial” in a strict sense or “Pascal” for the case of an integer-valued stopping-time parameter r, and use “Polya” for the real-valued case.
For occurrences of “contagious” discrete events, like tornado outbreaks, the Polya distributions can be used to give more accurate models than the Poisson distribution by allowing the mean and variance to be different, unlike the Poisson. “Contagious” events have positively correlated occurrences causing a larger variance than if the occurrences were independent, due to a positive covariance term.
Suppose there is a sequence of independent Bernoulli trials. Thus, each trial has two potential outcomes called “success” and “failure”. In each trial the probability of success is p and of failure is (1 − p). We are observing this sequence until a predefined number r of failures has occurred. Then the random number of successes we have seen, X, will have the negative binomial (or Pascal) distribution:
        X
        ∼
        NB
        ⁡
        (
        r
        ;
        p
        )
    {\displaystyle X\sim \operatorname {NB} (r;p)}
When applied to real-world problems, outcomes of success and failure may or may not be outcomes we ordinarily view as good and bad, respectively. Suppose we used the negative binomial distribution to model the number of days a certain machine works before it breaks down. In this case “success” would be the result on a day when the machine worked properly, whereas a breakdown would be a “failure”. If we used the negative binomial distribution to model the number of goal attempts a sportsman makes before scoring r goals, though, then each unsuccessful attempt would be a “success”, and scoring a goal would be “failure”. If we are tossing a coin, then the negative binomial distribution can give the number of heads (“success”) we are likely to encounter before we encounter a certain number of tails (“failure”). In the probability mass function below, p is the probability of success, and (1-p) is the probability of failure.
The probability mass function of the negative binomial distribution is
        f
        (
        k
        ;
        r
        ,
        p
        )
        ≡
        Pr
        (
        X
        =
        k
        )
        =
              (
                k
                +
                r
                −
                1
              k
              )
          p
            k
        (
        1
        −
        p
          )
            r
          for 
        k
        =
        0
        ,
        1
        ,
        2
        ,
        …
    {\displaystyle f(k;r,p)\equiv \Pr(X=k)={\binom {k+r-1}{k}}p^{k}(1-p)^{r}\quad {\text{for }}k=0,1,2,\dotsc }
Here the quantity in parentheses is the binomial coefficient, and is equal to
              (
                k
                +
                r
                −
                1
              k
              )
        =
              (
              k
              +
              r
              −
              1
              )
              !
              k
              !
              (
              r
              −
              1
              )
              !
        =
              (
              k
              +
              r
              −
              1
              )
              (
              k
              +
              r
              −
              2
              )
              ⋯
              (
              r
              )
              k
              !
        .
    {\displaystyle {\binom {k+r-1}{k}}={\frac {(k+r-1)!}{k!\,(r-1)!}}={\frac {(k+r-1)(k+r-2)\dotsm (r)}{k!}}.}
This quantity can alternatively be written in the following manner, explaining the name “negative binomial”:
              (
              k
              +
              r
              −
              1
              )
              ⋯
              (
              r
              )
              k
              !
        =
        (
        −
        1
          )
            k
              (
              −
              r
              )
              (
              −
              r
              −
              1
              )
              (
              −
              r
              −
              2
              )
              ⋯
              (
              −
              r
              −
              k
              +
              1
              )
              k
              !
        =
        (
        −
        1
          )
            k
              (
                −
                r
              k
              )
        .
    {\displaystyle {\frac {(k+r-1)\dotsm (r)}{k!}}=(-1)^{k}{\frac {(-r)(-r-1)(-r-2)\dotsm (-r-k+1)}{k!}}=(-1)^{k}{\binom {-r}{k}}.\qquad }
Note that by the last expression and the binomial series, for every 0 ≤ p < 1,
        (
        1
        −
        p
          )
            −
            r
        =
          ∑
            k
            =
            0
            ∞
              (
                −
                r
              k
              )
        (
        −
        p
          )
            k
        =
          ∑
            k
            =
            0
            ∞
              (
                k
                +
                r
                −
                1
              k
              )
          p
            k
    {\displaystyle (1-p)^{-r}=\sum _{k=0}^{\infty }{\binom {-r}{k}}(-p)^{k}=\sum _{k=0}^{\infty }{\binom {k+r-1}{k}}p^{k}}
  ,
hence the terms of the probability mass function indeed add up to one.
To understand the above definition of the probability mass function, note that the probability for every specific sequence of k successes and r failures is (1 − p)rpk, because the outcomes of the k + r trials are supposed to happen independently. Since the rth failure comes last, it remains to choose the k trials with successes out of the remaining k + r − 1 trials. The above binomial coefficient, due to its combinatorial interpretation, gives precisely the number of all these sequences of length k + r − 1.
The following recurrence relation holds:
          {
                  (
                  k
                  +
                  1
                  )
                  Pr
                  (
                  k
                  +
                  1
                  )
                  −
                  p
                  Pr
                  (
                  k
                  )
                  (
                  k
                  +
                  r
                  )
                  =
                  0
                  ,
                  Pr
                  (
                  0
                  )
                  =
                  (
                  1
                  −
                  p
                    )
                      r
          }
    {\displaystyle \left\{{\begin{array}{l}(k+1)\Pr(k+1)-p\Pr(k)(k+r)=0,\\[10pt]\Pr(0)=(1-p)^{r}\end{array}}\right\}}
The expected total number of trials k+r of a negative binomial distribution with parameters (r, p) is r/(1−p). To see this intuitively, imagine the above experiment is performed many times. That is, a set of trials is performed until r failures are obtained, then another set of trials, and then another etc. Write down the number of trials performed in each experiment: a, b, c, … and set a + b + c + … = N. Now we would expect about N(1−p) failures in total. Say the experiment was performed n times. Then there are nr failures in total. So we would expect nr = N(1−p), so N/n = r/(1−p). See that N/n is just the average number of trials per experiment. That is what we mean by "expectation". The average number of successes per experiment is N/n − r, which must have expected value equal to r/(1−p) − r = rp/(1−p). This agrees with the mean given in the box on the right-hand side of this page.
It is possible to extend the definition of the negative binomial distribution to the case of a positive real parameter r. Although it is impossible to visualize a non-integer number of “failures”, we can still formally define the distribution through its probability mass function.
The problem of extending the definition to real-valued (positive) r boils down to extending the binomial coefficient to its real-valued counterpart, based on the gamma function:
              (
                k
                +
                r
                −
                1
              k
              )
        =
              (
              k
              +
              r
              −
              1
              )
              (
              k
              +
              r
              −
              2
              )
              ⋯
              (
              r
              )
              k
              !
        =
              Γ
              (
              k
              +
              r
              )
              k
              !
              Γ
              (
              r
              )
        .
    {\displaystyle {\binom {k+r-1}{k}}={\frac {(k+r-1)(k+r-2)\dotsm (r)}{k!}}={\frac {\Gamma (k+r)}{k!\,\Gamma (r)}}.}
Now, after substituting this expression in the original definition, we say that X has a negative binomial (or Pólya) distribution if it has a probability mass function:
        f
        (
        k
        ;
        r
        ,
        p
        )
        ≡
        Pr
        (
        X
        =
        k
        )
        =
              Γ
              (
              k
              +
              r
              )
              k
              !
              Γ
              (
              r
              )
          p
            k
        (
        1
        −
        p
          )
            r
          for 
        k
        =
        0
        ,
        1
        ,
        2
        ,
        …
    {\displaystyle f(k;r,p)\equiv \Pr(X=k)={\frac {\Gamma (k+r)}{k!\,\Gamma (r)}}p^{k}(1-p)^{r}\quad {\text{for }}k=0,1,2,\dotsc }
Here r is a real, positive number.
Some textbooks may define the negative binomial distribution slightly differently from here. The most common variations are:
For the special case where r is an integer, the negative binomial distribution is known as the Pascal distribution. It is the probability distribution of a certain number of failures and successes in a series of independent and identically distributed Bernoulli trials. For k + r Bernoulli trials with success probability p, the negative binomial gives the probability of k successes and r failures, with a failure on the last trial. In other words, the negative binomial distribution is the probability distribution of the number of successes before the rth failure in a Bernoulli process, with probability p of successes on each trial. A Bernoulli process is a discrete time process, and so the number of trials, failures, and successes are integers.
Consider the following example. Suppose we repeatedly throw a dice, and consider a “1” to be a “failure”. The probability of success on each trial is 5/6. The number of successes before the third failure belongs to the infinite set { 0, 1, 2, 3, ... }. That number of successes is a negative-binomially distributed random variable.
When r = 1 we get the probability distribution of number of successes before the first failure (i.e. the probability of the first failure occurring on the (k + 1)st trial), which is a geometric distribution:
        f
        (
        k
        ;
        r
        ,
        p
        )
        =
        (
        1
        −
        p
        )
        ⋅
          p
            k
    {\displaystyle f(k;r,p)=(1-p)\cdot p^{k}\!}
The negative binomial distribution, especially in its alternative parameterization described above, can be used as an alternative to the Poisson distribution. It is especially useful for discrete data over an unbounded positive range whose sample variance exceeds the sample mean. In such cases, the observations are overdispersed with respect to a Poisson distribution, for which the mean is equal to the variance. Hence a Poisson distribution is not an appropriate model. Since the negative binomial distribution has one more parameter than the Poisson, the second parameter can be used to adjust the variance independently of the mean. See Cumulants of some discrete probability distributions.
An application of this is to annual counts of tropical cyclones in the North Atlantic or to monthly to 6-monthly counts of wintertime extratropical cyclones over Europe, for which the variance is greater than the mean. In the case of modest overdispersion, this may produce substantially similar results to an overdispersed Poisson distribution.
The negative binomial distribution is also commonly used to model gene expression in the form of discrete read count data from high-throughput RNA sequencing experiments.
The geometric distribution (on { 0, 1, 2, 3, ... }) is a special case of the negative binomial distribution, with
          Geom
        (
        p
        )
        =
          NB
        (
        1
        ,
        1
        −
        p
        )
        .
    {\displaystyle {\text{Geom}}(p)={\text{NB}}(1,\,1-p).\,}
The negative binomial distribution is a special case of the discrete phase-type distribution.
The negative binomial distribution is a special case of discrete Compound Poisson distribution.
Consider a sequence of negative binomial random variables where the stopping parameter r goes to infinity, whereas the probability of success in each trial, p, goes to zero in such a way as to keep the mean of the distribution constant. Denoting this mean λ, the parameter p will be p=λ/(λ+r)
        λ
        =
        r
            p
              1
              −
              p
        ⇒
        p
        =
            λ
              r
              +
              λ
        .
    {\displaystyle \lambda =r\,{\frac {p}{1-p}}\quad \Rightarrow \quad p={\frac {\lambda }{r+\lambda }}.}
Under this parametrization the probability mass function will be
        f
        (
        k
        ;
        r
        ,
        p
        )
        =
              Γ
              (
              k
              +
              r
              )
              k
              !
              ⋅
              Γ
              (
              r
              )
          p
            k
        (
        1
        −
        p
          )
            r
        =
              λ
                k
              k
              !
        ⋅
              Γ
              (
              r
              +
              k
              )
              Γ
              (
              r
              )
              (
              r
              +
              λ
                )
                  k
        ⋅
            1
                (
                1
                +
                    λ
                    r
                )
                r
    {\displaystyle f(k;r,p)={\frac {\Gamma (k+r)}{k!\cdot \Gamma (r)}}p^{k}(1-p)^{r}={\frac {\lambda ^{k}}{k!}}\cdot {\frac {\Gamma (r+k)}{\Gamma (r)\;(r+\lambda )^{k}}}\cdot {\frac {1}{\left(1+{\frac {\lambda }{r}}\right)^{r}}}}
Now if we consider the limit as r → ∞, the second factor will converge to one, and the third to the exponent function:
          lim
            r
            →
            ∞
        f
        (
        k
        ;
        r
        ,
        p
        )
        =
              λ
                k
              k
              !
        ⋅
        1
        ⋅
            1
              e
                λ
        ,
    {\displaystyle \lim _{r\to \infty }f(k;r,p)={\frac {\lambda ^{k}}{k!}}\cdot 1\cdot {\frac {1}{e^{\lambda }}},}
which is the mass function of a Poisson-distributed random variable with expected value λ.
In other words, the alternatively parameterized negative binomial distribution converges to the Poisson distribution and r controls the deviation from the Poisson. This makes the negative binomial distribution suitable as a robust alternative to the Poisson, which approaches the Poisson for large r, but which has larger variance than the Poisson for small r.
          Poisson
        (
        λ
        )
        =
          lim
            r
            →
            ∞
          NB
            (
        r
        ,
            λ
              λ
              +
              r
            )
        .
    {\displaystyle {\text{Poisson}}(\lambda )=\lim _{r\to \infty }{\text{NB}}{\Big (}r,\ {\frac {\lambda }{\lambda +r}}{\Big )}.}
The negative binomial distribution also arises as a continuous mixture of Poisson distributions (i.e. a compound probability distribution) where the mixing distribution of the Poisson rate is a gamma distribution. That is, we can view the negative binomial as a Poisson(λ) distribution, where λ is itself a random variable, distributed as a gamma distribution with shape = r and scale θ = p/(1 − p) or correspondingly rate β = (1 - p)/p.
Formally, this means that the mass function of the negative binomial distribution can be written as
                f
                (
                k
                ;
                r
                ,
                p
                )
                =
                  ∫
                    0
                    ∞
                  f
                      Poisson
                    (
                    λ
                    )
                (
                k
                )
                ⋅
                  f
                      Gamma
                      (
                      r
                      ,
                            1
                            −
                            p
                          p
                      )
                (
                λ
                )
                  d
                λ
                =
                  ∫
                    0
                    ∞
                      λ
                        k
                      k
                      !
                  e
                    −
                    λ
                ⋅
                  λ
                    r
                    −
                    1
                      e
                        −
                        λ
                        (
                        1
                        −
                        p
                        )
                          /
                        p
                          (
                          p
                            1
                            −
                            p
                            )
                          r
                      Γ
                      (
                      r
                      )
                  d
                λ
                =
                      (
                      1
                      −
                      p
                        )
                          r
                        p
                          −
                          r
                      k
                      !
                      Γ
                      (
                      r
                      )
                  ∫
                    0
                    ∞
                  λ
                    r
                    +
                    k
                    −
                    1
                  e
                    −
                    λ
                      /
                    p
                  d
                λ
                =
                      (
                      1
                      −
                      p
                        )
                          r
                        p
                          −
                          r
                      k
                      !
                      Γ
                      (
                      r
                      )
                  p
                    r
                    +
                    k
                Γ
                (
                r
                +
                k
                )
                =
                      Γ
                      (
                      r
                      +
                      k
                      )
                      k
                      !
                      Γ
                      (
                      r
                      )
                  p
                    k
                (
                1
                −
                p
                  )
                    r
                .
    {\displaystyle {\begin{aligned}f(k;r,p)&=\int _{0}^{\infty }f_{{\text{Poisson}}(\lambda )}(k)\cdot f_{{\text{Gamma}}\left(r,\,{\frac {1-p}{p}}\right)}(\lambda )\;\mathrm {d} \lambda \\[8pt]&=\int _{0}^{\infty }{\frac {\lambda ^{k}}{k!}}e^{-\lambda }\cdot \lambda ^{r-1}{\frac {e^{-\lambda (1-p)/p}}{{\big (}{\frac {p}{1-p}}{\big )}^{r}\,\Gamma (r)}}\;\mathrm {d} \lambda \\[8pt]&={\frac {(1-p)^{r}p^{-r}}{k!\,\Gamma (r)}}\int _{0}^{\infty }\lambda ^{r+k-1}e^{-\lambda /p}\;\mathrm {d} \lambda \\[8pt]&={\frac {(1-p)^{r}p^{-r}}{k!\,\Gamma (r)}}\ p^{r+k}\,\Gamma (r+k)\\[8pt]&={\frac {\Gamma (r+k)}{k!\;\Gamma (r)}}\;p^{k}(1-p)^{r}.\end{aligned}}}
Because of this, the negative binomial distribution is also known as the gamma–Poisson (mixture) distribution.
Note: The negative binomial distribution was originally derived as a limiting case of the gamma-Poisson distribution.
If Yr is a random variable following the negative binomial distribution with parameters r and p, and support {0, 1, 2, ...}, then Yr is a sum of r independent variables following the geometric distribution (on {0, 1, 2, ...}) with parameter 1-p. As a result of the central limit theorem, Yr (properly scaled and shifted) is therefore approximately normal for sufficiently large r.
Furthermore, if Bs+r is a random variable following the binomial distribution with parameters s + r and 1 − p, then
                Pr
                (
                  Y
                    r
                ≤
                s
                )
                =
                1
                −
                  I
                    p
                (
                s
                +
                1
                ,
                r
                )
                =
                1
                −
                  I
                    p
                (
                (
                s
                +
                r
                )
                −
                (
                r
                −
                1
                )
                ,
                (
                r
                −
                1
                )
                +
                1
                )
                =
                1
                −
                Pr
                (
                  B
                    s
                    +
                    r
                ≤
                r
                −
                1
                )
                =
                Pr
                (
                  B
                    s
                    +
                    r
                ≥
                r
                )
                =
                Pr
                (
                  after 
                s
                +
                r
                   trials, there are at least 
                r
                   successes
                )
                .
    {\displaystyle {\begin{aligned}\Pr(Y_{r}\leq s)&{}=1-I_{p}(s+1,r)\\&{}=1-I_{p}((s+r)-(r-1),(r-1)+1)\\&{}=1-\Pr(B_{s+r}\leq r-1)\\&{}=\Pr(B_{s+r}\geq r)\\&{}=\Pr({\text{after }}s+r{\text{ trials, there are at least }}r{\text{ successes}}).\end{aligned}}}
In this sense, the negative binomial distribution is the "inverse" of the binomial distribution.
The sum of independent negative-binomially distributed random variables r1 and r2 with the same value for parameter p is negative-binomially distributed with the same p but with "r-value" r1 + r2.
The negative binomial distribution is infinitely divisible, i.e., if Y has a negative binomial distribution, then for any positive integer n, there exist independent identically distributed random variables Y1, ..., Yn whose sum has the same distribution that Y has.
The negative binomial distribution NB(r,p) can be represented as a compound Poisson distribution: Let {Yn, n ∈ ℕ0} denote a sequence of independent and identically distributed random variables, each one having the logarithmic distribution Log(p), with probability mass function
        f
        (
        k
        ;
        r
        ,
        p
        )
        =
              −
                p
                  k
              k
              ln
              ⁡
              (
              1
              −
              p
              )
        ,
        k
        ∈
            N
        .
    {\displaystyle f(k;r,p)={\frac {-p^{k}}{k\ln(1-p)}},\qquad k\in {\mathbb {N} }.}
Let N be a random variable, independent of the sequence, and suppose that N has a Poisson distribution with mean λ = −r ln(1 − p). Then the random sum
        X
        =
          ∑
            n
            =
            1
            N
          Y
            n
    {\displaystyle X=\sum _{n=1}^{N}Y_{n}}
is NB(r,p)-distributed. To prove this, we calculate the probability generating function GX of X, which is the composition of the probability generating functions GN and GY1. Using
          G
            N
        (
        z
        )
        =
        exp
        ⁡
        (
        λ
        (
        z
        −
        1
        )
        )
        ,
        z
        ∈
          R
        ,
    {\displaystyle G_{N}(z)=\exp(\lambda (z-1)),\qquad z\in \mathbb {R} ,}
and
          G
              Y
                1
        (
        z
        )
        =
              ln
              ⁡
              (
              1
              −
              p
              z
              )
              ln
              ⁡
              (
              1
              −
              p
              )
        ,
          |
        z
          |
        <
            1
            p
        ,
    {\displaystyle G_{Y_{1}}(z)={\frac {\ln(1-pz)}{\ln(1-p)}},\qquad |z|<{\frac {1}{p}},}
we obtain
                  G
                    X
                (
                z
                )
                =
                  G
                    N
                (
                  G
                      Y
                        1
                (
                z
                )
                )
                =
                exp
                ⁡
                    (
                λ
                    (
                      ln
                      ⁡
                      (
                      1
                      −
                      p
                      z
                      )
                      ln
                      ⁡
                      (
                      1
                      −
                      p
                      )
                −
                1
                    )
                    )
                =
                exp
                ⁡
                    (
                −
                r
                (
                ln
                ⁡
                (
                1
                −
                p
                z
                )
                −
                ln
                ⁡
                (
                1
                −
                p
                )
                )
                    )
                =
                    (
                      1
                      −
                      p
                      1
                      −
                      p
                      z
                      )
                    r
                ,
                  |
                z
                  |
                <
                    1
                    p
                ,
    {\displaystyle {\begin{aligned}G_{X}(z)&=G_{N}(G_{Y_{1}}(z))\\&=\exp {\biggl (}\lambda {\biggl (}{\frac {\ln(1-pz)}{\ln(1-p)}}-1{\biggr )}{\biggr )}\\&=\exp {\bigl (}-r(\ln(1-pz)-\ln(1-p)){\bigr )}\\&={\biggl (}{\frac {1-p}{1-pz}}{\biggr )}^{r},\qquad |z|<{\frac {1}{p}},\end{aligned}}}
which is the probability generating function of the NB(r,p) distribution.
The following table describes four distributions related to the number of successes in a sequence of draws:
The cumulative distribution function can be expressed in terms of the regularized incomplete beta function:
        f
        (
        k
        ;
        r
        ,
        p
        )
        ≡
        Pr
        (
        X
        ≤
        k
        )
        =
        1
        −
          I
            p
        (
        k
        +
        1
        ,
        r
        )
        =
          I
            1
            −
            p
        (
        r
        ,
        k
        +
        1
        )
        .
    {\displaystyle f(k;r,p)\equiv \Pr(X\leq k)=1-I_{p}(k+1,r)=I_{1-p}(r,k+1).}
Suppose p is unknown and an experiment is conducted where it is decided ahead of time that sampling will continue until r successes are found. A sufficient statistic for the experiment is k, the number of failures.
In estimating p, the minimum variance unbiased estimator is
              p
              ^
        =
              r
              −
              1
              r
              +
              k
              −
              1
        .
    {\displaystyle {\hat {p}}={\frac {r-1}{r+k-1}}.}
The maximum likelihood estimate of p is
              p
              ~
        =
            r
              r
              +
              k
        ,
    {\displaystyle {\tilde {p}}={\frac {r}{r+k}},}
but this is a biased estimate. Its inverse (r + k)/r, is an unbiased estimate of 1/p, however.
Suppose Y is a random variable with a binomial distribution with parameters n and p. Assume p + q = 1, with p, q >=0. Then the binomial theorem implies that
        1
        =
          1
            n
        =
        (
        p
        +
        q
          )
            n
        =
          ∑
            k
            =
            0
            n
              (
              n
              k
              )
          p
            k
          q
            n
            −
            k
        .
    {\displaystyle 1=1^{n}=(p+q)^{n}=\sum _{k=0}^{n}{n \choose k}p^{k}q^{n-k}.}
Using Newton's binomial theorem, this can equally be written as:
        (
        p
        +
        q
          )
            n
        =
          ∑
            k
            =
            0
            ∞
              (
              n
              k
              )
          p
            k
          q
            n
            −
            k
        ,
    {\displaystyle (p+q)^{n}=\sum _{k=0}^{\infty }{n \choose k}p^{k}q^{n-k},}
in which the upper bound of summation is infinite. In this case, the binomial coefficient
              (
              n
              k
              )
        =
              n
              (
              n
              −
              1
              )
              (
              n
              −
              2
              )
              ⋯
              (
              n
              −
              k
              +
              1
              )
              k
              !
        .
    {\displaystyle {n \choose k}={n(n-1)(n-2)\cdots (n-k+1) \over k!}.}
is defined when n is a real number, instead of just a positive integer. But in our case of the binomial distribution it is zero when k > n. We can then say, for example
        (
        p
        +
        q
          )
            8.3
        =
          ∑
            k
            =
            0
            ∞
              (
              8.3
              k
              )
          p
            k
          q
            8.3
            −
            k
        .
    {\displaystyle (p+q)^{8.3}=\sum _{k=0}^{\infty }{8.3 \choose k}p^{k}q^{8.3-k}.}
Now suppose r > 0 and we use a negative exponent:
        1
        =
          p
            r
        ⋅
          p
            −
            r
        =
          p
            r
        (
        1
        −
        q
          )
            −
            r
        =
          p
            r
          ∑
            k
            =
            0
            ∞
              (
                −
                r
              k
              )
        (
        −
        q
          )
            k
        .
    {\displaystyle 1=p^{r}\cdot p^{-r}=p^{r}(1-q)^{-r}=p^{r}\sum _{k=0}^{\infty }{-r \choose k}(-q)^{k}.}
Then all of the terms are positive, and the term
          p
            r
              (
                −
                r
              k
              )
        (
        −
        q
          )
            k
    {\displaystyle p^{r}{-r \choose k}(-q)^{k}}
is just the probability that the number of failures before the rth success is equal to k, provided r is an integer. (If r is a negative non-integer, so that the exponent is a positive non-integer, then some of the terms in the sum above are negative, so we do not have a probability distribution on the set of all nonnegative integers.)
Now we also allow non-integer values of r. Then we have a proper negative binomial distribution, which is a generalization of the Pascal distribution, which coincides with the Pascal distribution when r happens to be a positive integer.
Recall from above that
The sum of independent negative-binomially distributed random variables r1 and r2 with the same value for parameter p is negative-binomially distributed with the same p but with "r-value" r1 + r2.
This property persists when the definition is thus generalized, and affords a quick way to see that the negative binomial distribution is infinitely divisible.
The maximum likelihood estimator only exists for samples for which the sample variance is larger than the sample mean. The likelihood function for N iid observations (k1, ..., kN) is
        L
        (
        r
        ,
        p
        )
        =
          ∏
            i
            =
            1
            N
        f
        (
          k
            i
        ;
        r
        ,
        p
        )
    {\displaystyle L(r,p)=\prod _{i=1}^{N}f(k_{i};r,p)\,\!}
from which we calculate the log-likelihood function
        ℓ
        (
        r
        ,
        p
        )
        =
          ∑
            i
            =
            1
            N
        ln
        ⁡
          (
          Γ
          (
            k
              i
          +
          r
          )
          )
        −
          ∑
            i
            =
            1
            N
        ln
        ⁡
        (
          k
            i
        !
        )
        −
        N
        ln
        ⁡
          (
          Γ
          (
          r
          )
          )
        +
          ∑
            i
            =
            1
            N
          k
            i
        ln
        ⁡
          (
          p
          )
        +
        N
        r
        ln
        ⁡
        (
        1
        −
        p
        )
        .
    {\displaystyle \ell (r,p)=\sum _{i=1}^{N}\ln {(\Gamma (k_{i}+r))}-\sum _{i=1}^{N}\ln(k_{i}!)-N\ln {(\Gamma (r))}+\sum _{i=1}^{N}k_{i}\ln {(p)}+Nr\ln(1-p).}
To find the maximum we take the partial derivatives with respect to r and p and set them equal to zero:
              ∂
              ℓ
              (
              r
              ,
              p
              )
              ∂
              p
        =
          [
            ∑
              i
              =
              1
              N
            k
              i
              1
              p
          ]
        −
        N
        r
            1
              1
              −
              p
        =
        0
    {\displaystyle {\frac {\partial \ell (r,p)}{\partial p}}=\left[\sum _{i=1}^{N}k_{i}{\frac {1}{p}}\right]-Nr{\frac {1}{1-p}}=0}
   and
              ∂
              ℓ
              (
              r
              ,
              p
              )
              ∂
              r
        =
          [
            ∑
              i
              =
              1
              N
          ψ
          (
            k
              i
          +
          r
          )
          ]
        −
        N
        ψ
        (
        r
        )
        +
        N
        ln
        ⁡
          (
          1
          −
          p
          )
        =
        0
    {\displaystyle {\frac {\partial \ell (r,p)}{\partial r}}=\left[\sum _{i=1}^{N}\psi (k_{i}+r)\right]-N\psi (r)+N\ln {(1-p)}=0}
where
        ψ
        (
        k
        )
        =
                Γ
                ′
              (
              k
              )
              Γ
              (
              k
              )
    {\displaystyle \psi (k)={\frac {\Gamma '(k)}{\Gamma (k)}}\!}
   is the digamma function.
Solving the first equation for p gives:
        p
        =
                ∑
                  i
                  =
                  1
                  N
                k
                  i
              N
              r
              +
                ∑
                  i
                  =
                  1
                  N
                k
                  i
    {\displaystyle p={\frac {\sum _{i=1}^{N}k_{i}}{Nr+\sum _{i=1}^{N}k_{i}}}}
Substituting this in the second equation gives:
              ∂
              ℓ
              (
              r
              ,
              p
              )
              ∂
              r
        =
          [
            ∑
              i
              =
              1
              N
          ψ
          (
            k
              i
          +
          r
          )
          ]
        −
        N
        ψ
        (
        r
        )
        +
        N
        ln
        ⁡
            (
                r
                  r
                  +
                    ∑
                      i
                      =
                      1
                      N
                    k
                      i
                    /
                  N
            )
        =
        0
    {\displaystyle {\frac {\partial \ell (r,p)}{\partial r}}=\left[\sum _{i=1}^{N}\psi (k_{i}+r)\right]-N\psi (r)+N\ln {\left({\frac {r}{r+\sum _{i=1}^{N}k_{i}/N}}\right)}=0}
This equation cannot be solved for r in closed form. If a numerical solution is desired, an iterative technique such as Newton's method can be used. Alternatively, the expectation–maximization algorithm can be used.
Pat is required to sell candy bars to raise money for the 6th grade field trip. There are thirty houses in the neighborhood, and Pat is not supposed to return home until five candy bars have been sold. So the child goes door to door, selling candy bars. At each house, there is a 0.4 probability of selling one candy bar and a 0.6 probability of selling nothing.
What's the probability of selling the last candy bar at the nth house?
Recall that the NegBin(r, p) distribution describes the probability of k failures and r successes in k + r Bernoulli(p) trials with success on the last trial. Selling five candy bars means getting five successes. The number of trials (i.e. houses) this takes is therefore k + 5 = n. The random variable we are interested in is the number of houses, so we substitute k = n − 5 into a NegBin(5, 0.4) mass function and obtain the following mass function of the distribution of houses (for n ≥ 5):
        f
        (
        n
        )
        =
              (
                (
                n
                −
                5
                )
                +
                5
                −
                1
                n
                −
                5
              )
          0.4
            5
          0.6
            n
            −
            5
        =
              (
                n
                −
                1
                n
                −
                5
              )
          2
            5
              3
                n
                −
                5
              5
                n
        .
    {\displaystyle f(n)={(n-5)+5-1 \choose n-5}\;0.4^{5}\;0.6^{n-5}={n-1 \choose n-5}\;2^{5}\;{\frac {3^{n-5}}{5^{n}}}.}
What's the probability that Pat finishes on the tenth house?
        f
        (
        10
        )
        =
        0.1003290624.
    {\displaystyle f(10)=0.1003290624.\,}
What's the probability that Pat finishes on or before reaching the eighth house?
To finish on or before the eighth house, Pat must finish at the fifth, sixth, seventh, or eighth house. Sum those probabilities:
        f
        (
        5
        )
        =
        0.01024
    {\displaystyle f(5)=0.01024\,}
        f
        (
        6
        )
        =
        0.03072
    {\displaystyle f(6)=0.03072\,}
        f
        (
        7
        )
        =
        0.055296
    {\displaystyle f(7)=0.055296\,}
        f
        (
        8
        )
        =
        0.0774144
    {\displaystyle f(8)=0.0774144\,}
          ∑
            j
            =
            5
            8
        f
        (
        j
        )
        =
        0.17367.
    {\displaystyle \sum _{j=5}^{8}f(j)=0.17367.}
What's the probability that Pat exhausts all 30 houses in the neighborhood?
This can be expressed as the probability that Pat does not finish on the fifth through the thirtieth house:
        1
        −
          ∑
            j
            =
            5
            30
        f
        (
        j
        )
        =
        1
        −
          I
            0.4
        (
        5
        ,
        30
        −
        5
        +
        1
        )
        ≈
        1
        −
        0.99849
        =
        0.00151.
    {\displaystyle 1-\sum _{j=5}^{30}f(j)=1-I_{0.4}(5,30-5+1)\approx 1-0.99849=0.00151.}
Hospital length of stay is an example of real world data that can be modelled well with a negative binomial distribution.
Coupon collector's problem
Beta negative binomial distribution
Extended negative binomial distribution
Negative multinomial distribution
Binomial distribution
Poisson distribution
Exponential family
Vector generalized linear model
Compound Poisson distribution
