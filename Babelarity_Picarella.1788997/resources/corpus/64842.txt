A multipole expansion is a mathematical series representing a function that depends on angles — usually the two angles on a sphere. These series are useful because they can often be truncated, meaning that only the first few terms need to be retained for a good approximation to the original function. The function being expanded may be complex in general. Multipole expansions are very frequently used in the study of electromagnetic, gravitational fields and aeroacoustics, where the fields at distant points are given in terms of sources in a small region  . The multipole expansion with angles is often combined with an expansion in radius. Such a combination gives an expansion describing a function throughout three-dimensional space.
The multipole expansion is expressed as a sum of terms with progressively finer angular features. For example, the initial term — called the zero-th, or monopole, moment — is a constant, independent of angle. The following term — the first, or dipole, moment — varies once from positive to negative around the sphere. Higher-order terms (like the quadrupole and octupole) vary more quickly with angles. A multipole moment usually involves powers (or inverse powers) of the distance to the origin, as well as some angular dependence.
In principle, a multipole expansion provides an exact description of the potential and generally converges under two conditions: (1) if the sources (e.g., charges) are localized close to the origin and the point at which the potential is observed is far from the origin; or (2) the reverse, i.e., if the sources (e.g., charges) are located far from the origin and the potential is observed close to the origin. In the first (more common) case, the coefficients of the series expansion are called exterior multipole moments or simply multipole moments whereas, in the second case, they are called interior multipole moments. The first (the zeroth-order) term in the expansion is called the monopole moment, the second (the first-order) term is denoted as the dipole moment, and the third (the second-order), fourth (the third-order), etc. terms are denoted as quadrupole, octupole, etc. moments.
Most commonly, the series is written as a sum of spherical harmonics. Thus, we might write a function 
        f
        (
        θ
        ,
        ϕ
        )
    {\displaystyle f(\theta ,\phi )}
   as the sum
        f
        (
        θ
        ,
        ϕ
        )
        =
          ∑
            l
            =
            0
            ∞
          ∑
            m
            =
            −
            l
            l
          C
            l
            m
          Y
            l
            m
        (
        θ
        ,
        ϕ
        )
        .
    {\displaystyle f(\theta ,\phi )=\sum _{l=0}^{\infty }\,\sum _{m=-l}^{l}\,C_{l}^{m}\,Y_{l}^{m}(\theta ,\phi ).}
Here, 
          Y
            l
            m
        (
        θ
        ,
        ϕ
        )
    {\displaystyle Y_{l}^{m}(\theta ,\phi )}
   are the standard spherical harmonics, and 
          C
            l
            m
    {\displaystyle C_{l}^{m}}
   are constant coefficients which depend on the function. The term 
          C
            0
            0
    {\displaystyle C_{0}^{0}}
   represents the monopole; 
          C
            1
            −
            1
        ,
          C
            1
            0
        ,
          C
            1
            1
    {\displaystyle C_{1}^{-1},C_{1}^{0},C_{1}^{1}}
   represent the dipole; and so on. Equivalently, the series is also frequently written as
        f
        (
        θ
        ,
        ϕ
        )
        =
        C
        +
          C
            i
          n
            i
        +
          C
            i
            j
          n
            i
          n
            j
        +
          C
            i
            j
            k
          n
            i
          n
            j
          n
            k
        +
          C
            i
            j
            k
            l
          n
            i
          n
            j
          n
            k
          n
            l
        +
        ⋯
        .
    {\displaystyle f(\theta ,\phi )=C+C_{i}n^{i}+C_{ij}n^{i}n^{j}+C_{ijk}n^{i}n^{j}n^{k}+C_{ijkl}n^{i}n^{j}n^{k}n^{l}+\cdots .}
Here, the 
          n
            i
    {\displaystyle n^{i}}
   represent the components of a unit vector in the direction given by the angles 
        θ
    {\displaystyle \theta }
   and 
        ϕ
    {\displaystyle \phi }
  , and indices are implicitly summed. Here, the term 
        C
    {\displaystyle C}
   is the monopole; 
          C
            i
    {\displaystyle C_{i}}
   is a set of three numbers representing the dipole; and so on.
In the above expansions, the coefficients may be real or complex. If the function being expressed as a multipole expansion is real, however, the coefficients must satisfy certain properties. In the spherical harmonic expansion, we must have
          C
            l
            −
            m
        =
        (
        −
        1
          )
            m
          C
            l
            m
            ∗
        .
    {\displaystyle C_{l}^{-m}=(-1)^{m}C_{l}^{m\ast }\ .}
In the multi-vector expansion, each coefficient must be real:
        C
        =
          C
            ∗
        ;
          C
            i
        =
          C
            i
            ∗
        ;
          C
            i
            j
        =
          C
            i
            j
            ∗
        ;
          C
            i
            j
            k
        =
          C
            i
            j
            k
            ∗
        ;
        …
    {\displaystyle C=C^{\ast };\ C_{i}=C_{i}^{\ast };\ C_{ij}=C_{ij}^{\ast };\ C_{ijk}=C_{ijk}^{\ast };\ \ldots }
While expansions of scalar functions are by far the most common application of multipole expansions, they may also be generalized to describe tensors of arbitrary rank. This finds use in multipole expansions of the vector potential in electromagnetism, or the metric perturbation in the description of gravitational waves.
For describing functions of three dimensions, away from the coordinate origin, the coefficients of the multipole expansion can be written as functions of the distance to the origin, 
        r
    {\displaystyle r}
  —most frequently, as a Laurent series in powers of 
        r
    {\displaystyle r}
  . For example, to describe the electromagnetic potential, 
        V
    {\displaystyle V}
  , from a source in a small region near the origin, the coefficients may be written as:
        V
        (
        r
        ,
        θ
        ,
        ϕ
        )
        =
          ∑
            l
            =
            0
            ∞
          ∑
            m
            =
            −
            l
            l
          C
            l
            m
        (
        r
        )
          Y
            l
            m
        (
        θ
        ,
        ϕ
        )
        =
          ∑
            j
            =
            1
            ∞
          ∑
            l
            =
            0
            ∞
          ∑
            m
            =
            −
            l
            l
              D
                l
                ,
                j
                m
              r
                j
          Y
            l
            m
        (
        θ
        ,
        ϕ
        )
        .
    {\displaystyle V(r,\theta ,\phi )=\sum _{l=0}^{\infty }\,\sum _{m=-l}^{l}\,C_{l}^{m}(r)\,Y_{l}^{m}(\theta ,\phi )=\sum _{j=1}^{\infty }\,\sum _{l=0}^{\infty }\,\sum _{m=-l}^{l}\,{\frac {D_{l,j}^{m}}{r^{j}}}\,Y_{l}^{m}(\theta ,\phi ).}
Multipole expansions are widely used in problems involving gravitational fields of systems of masses, electric and magnetic fields of charge and current distributions, and the propagation of electromagnetic waves. A classic example is the calculation of the exterior multipole moments of atomic nuclei from their interaction energies with the interior multipoles of the electronic orbitals. The multipole moments of the nuclei report on the distribution of charges within the nucleus and, thus, on the shape of the nucleus. Truncation of the multipole expansion to its first non-zero term is often useful for theoretical calculations.
Multipole expansions are also useful in numerical simulations, and form the basis of the Fast Multipole Method of Greengard and Rokhlin, a general technique for efficient computation of energies and forces in systems of interacting particles. The basic idea is to decompose the particles into groups; particles within a group interact normally (i.e., by the full potential), whereas the energies and forces between groups of particles are calculated from their multipole moments. The efficiency of the fast multipole method is generally similar to that of Ewald summation, but is superior if the particles are clustered, i.e., if the system has large density fluctuations.
Consider a discrete charge distribution consisting of N point charges qi with position vectors ri. We assume the charges to be clustered around the origin, so that for all i: ri < rmax, where rmax has some finite value. The potential V(R), due to the charge distribution, at a point R outside the charge distribution, i.e., |R| > rmax, can be expanded in powers of 1/R. Two ways of making this expansion can be found in the literature. The first is a Taylor series in the Cartesian coordinates x, y, and z, while the second is in terms of spherical harmonics which depend on spherical polar coordinates. The Cartesian approach has the advantage that no prior knowledge of Legendre functions, spherical harmonics, etc., is required. Its disadvantage is that the derivations are fairly cumbersome (in fact a large part of it is the implicit rederivation of the Legendre expansion of 1/|r-R|, which was done once and for all by Legendre in the 1780s). Also it is difficult to give a closed expression for a general term of the multipole expansion—usually only the first few terms are given followed by an ellipsis.
The Taylor expansion of an arbitrary function v(R-r) around the origin r = 0 is
        v
        (
          r
        −
          R
        )
        =
        v
        (
          R
        )
        −
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          r
            α
          v
            α
        (
          R
        )
        +
            1
            2
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          ∑
            β
            =
            x
            ,
            y
            ,
            z
          r
            α
          r
            β
          v
            α
            β
        (
          R
        )
        −
        ⋯
        +
        ⋯
    {\displaystyle v(\mathbf {r} -\mathbf {R} )=v(\mathbf {R} )-\sum _{\alpha =x,y,z}r_{\alpha }v_{\alpha }(\mathbf {R} )+{\frac {1}{2}}\sum _{\alpha =x,y,z}\sum _{\beta =x,y,z}r_{\alpha }r_{\beta }v_{\alpha \beta }(\mathbf {R} )-\cdots +\cdots }
with
          v
            α
        (
          R
        )
        ≡
            (
                  ∂
                  v
                  (
                    r
                  −
                    R
                  )
                  ∂
                    r
                      α
            )
              r
            =
              0
          and
          v
            α
            β
        (
          R
        )
        ≡
            (
                    ∂
                      2
                  v
                  (
                    r
                  −
                    R
                  )
                  ∂
                    r
                      α
                  ∂
                    r
                      β
            )
              r
            =
              0
        .
    {\displaystyle v_{\alpha }(\mathbf {R} )\equiv \left({\frac {\partial v(\mathbf {r} -\mathbf {R} )}{\partial r_{\alpha }}}\right)_{\mathbf {r} =\mathbf {0} }\quad {\hbox{and}}\quad v_{\alpha \beta }(\mathbf {R} )\equiv \left({\frac {\partial ^{2}v(\mathbf {r} -\mathbf {R} )}{\partial r_{\alpha }\partial r_{\beta }}}\right)_{\mathbf {r} =\mathbf {0} }.}
If v(r-R) satisfies the Laplace equation
            (
              ∇
                2
            v
            (
              r
            −
              R
            )
            )
              r
            =
              0
        =
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          v
            α
            α
        (
          R
        )
        =
        0
    {\displaystyle \left(\nabla ^{2}v(\mathbf {r} -\mathbf {R} )\right)_{\mathbf {r} =\mathbf {0} }=\sum _{\alpha =x,y,z}v_{\alpha \alpha }(\mathbf {R} )=0}
then the expansion can be rewritten in terms of the components of a traceless Cartesian second rank tensor:
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          ∑
            β
            =
            x
            ,
            y
            ,
            z
          r
            α
          r
            β
          v
            α
            β
        (
          R
        )
        =
            1
            3
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          ∑
            β
            =
            x
            ,
            y
            ,
            z
        (
        3
          r
            α
          r
            β
        −
          δ
            α
            β
          r
            2
        )
          v
            α
            β
        (
          R
        )
        ,
    {\displaystyle \sum _{\alpha =x,y,z}\sum _{\beta =x,y,z}r_{\alpha }r_{\beta }v_{\alpha \beta }(\mathbf {R} )={\frac {1}{3}}\sum _{\alpha =x,y,z}\sum _{\beta =x,y,z}(3r_{\alpha }r_{\beta }-\delta _{\alpha \beta }r^{2})v_{\alpha \beta }(\mathbf {R} ),}
where δαβ is the Kronecker delta and r2 ≡ |r|2. Removing the trace is common, because it takes the rotationally invariant r2 out of the second rank tensor.
Example
Consider now the following form of v(r-R):
        v
        (
          r
        −
          R
        )
        ≡
            1
                |
                r
              −
                R
                |
        .
    {\displaystyle v(\mathbf {r} -\mathbf {R} )\equiv {\frac {1}{|\mathbf {r} -\mathbf {R} |}}.}
Then by direct differentiation it follows that
        v
        (
          R
        )
        =
            1
            R
        ,
          v
            α
        (
          R
        )
        =
        −
              R
                α
              R
                3
        ,
          and
          v
            α
            β
        (
          R
        )
        =
              3
                R
                  α
                R
                  β
              −
                δ
                  α
                  β
                R
                  2
              R
                5
        .
    {\displaystyle v(\mathbf {R} )={\frac {1}{R}},\quad v_{\alpha }(\mathbf {R} )=-{\frac {R_{\alpha }}{R^{3}}},\quad {\hbox{and}}\quad v_{\alpha \beta }(\mathbf {R} )={\frac {3R_{\alpha }R_{\beta }-\delta _{\alpha \beta }R^{2}}{R^{5}}}.}
Define a monopole, dipole, and (traceless) quadrupole by, respectively,
          q
              t
              o
              t
        ≡
          ∑
            i
            =
            1
            N
          q
            i
        ,
          P
            α
        ≡
          ∑
            i
            =
            1
            N
          q
            i
          r
            i
            α
        ,
          and
          Q
            α
            β
        ≡
          ∑
            i
            =
            1
            N
          q
            i
        (
        3
          r
            i
            α
          r
            i
            β
        −
          δ
            α
            β
          r
            i
            2
        )
        ,
    {\displaystyle q_{\mathrm {tot} }\equiv \sum _{i=1}^{N}q_{i},\quad P_{\alpha }\equiv \sum _{i=1}^{N}q_{i}r_{i\alpha },\quad {\hbox{and}}\quad Q_{\alpha \beta }\equiv \sum _{i=1}^{N}q_{i}(3r_{i\alpha }r_{i\beta }-\delta _{\alpha \beta }r_{i}^{2}),}
and we obtain finally the first few terms of the multipole expansion of the total potential, which is the sum of the Coulomb potentials of the separate charges:
        4
        π
          ε
            0
        V
        (
          R
        )
        ≡
          ∑
            i
            =
            1
            N
          q
            i
        v
        (
            r
            i
        −
          R
        )
    {\displaystyle 4\pi \varepsilon _{0}V(\mathbf {R} )\equiv \sum _{i=1}^{N}q_{i}v(\mathbf {r} _{i}-\mathbf {R} )}
        =
              q
                  t
                  o
                  t
            R
        +
            1
              R
                3
          ∑
            α
            =
            x
            ,
            y
            ,
            z
          P
            α
          R
            α
        +
            1
              2
                R
                  5
          ∑
            α
            ,
            β
            =
            x
            ,
            y
            ,
            z
          Q
            α
            β
        (
        3
          R
            α
          R
            β
        )
        +
        ⋯
    {\displaystyle ={\frac {q_{\mathrm {tot} }}{R}}+{\frac {1}{R^{3}}}\sum _{\alpha =x,y,z}P_{\alpha }R_{\alpha }+{\frac {1}{2R^{5}}}\sum _{\alpha ,\beta =x,y,z}Q_{\alpha \beta }(3R_{\alpha }R_{\beta })+\cdots }
This expansion of the potential of a discrete charge distribution is very similar to the one in real solid harmonics given below. The main difference is that the present one is in terms of linear dependent quantities, for
          ∑
            α
          v
            α
            α
        =
        0
          and
          ∑
            α
          Q
            α
            α
        =
        0.
    {\displaystyle \sum _{\alpha }v_{\alpha \alpha }=0\quad {\hbox{and}}\quad \sum _{\alpha }Q_{\alpha \alpha }=0.}
NOTE: If the charge distribution consists of two charges of opposite sign which are an infinitesimal distance d apart, so that d/R >> (d/R)2, it is easily shown that the only non-vanishing term in the expansion is
        V
        (
          R
        )
        =
            1
              4
              π
                ε
                  0
                R
                  3
        (
          P
        ⋅
          R
        )
        ,
    {\displaystyle V(\mathbf {R} )={\frac {1}{4\pi \varepsilon _{0}R^{3}}}(\mathbf {P} \cdot \mathbf {R} ),}
the electric dipolar potential field.
The potential V(R) at a point R outside the charge distribution, i.e., |R| > rmax, can be expanded by the Laplace expansion:
        V
        (
          R
        )
        ≡
          ∑
            i
            =
            1
            N
              q
                i
              4
              π
                ε
                  0
                |
                  r
                  i
              −
                R
                |
        =
            1
              4
              π
                ε
                  0
          ∑
            ℓ
            =
            0
            ∞
          ∑
            m
            =
            −
            ℓ
            ℓ
        (
        −
        1
          )
            m
          I
            ℓ
            −
            m
        (
          R
        )
          ∑
            i
            =
            1
            N
          q
            i
          R
            ℓ
            m
        (
            r
            i
        )
        ,
    {\displaystyle V(\mathbf {R} )\equiv \sum _{i=1}^{N}{\frac {q_{i}}{4\pi \varepsilon _{0}|\mathbf {r} _{i}-\mathbf {R} |}}={\frac {1}{4\pi \varepsilon _{0}}}\sum _{\ell =0}^{\infty }\sum _{m=-\ell }^{\ell }(-1)^{m}I_{\ell }^{-m}(\mathbf {R} )\sum _{i=1}^{N}q_{i}R_{\ell }^{m}(\mathbf {r} _{i}),}
where 
          I
            ℓ
            −
            m
        (
          R
        )
    {\displaystyle I_{\ell }^{-m}(\mathbf {R} )}
   is an irregular solid harmonic (defined below as a spherical harmonic function divided by 
          r
            ℓ
            +
            1
    {\displaystyle r^{\ell +1}}
  ) and 
          R
            ℓ
            m
        (
          r
        )
    {\displaystyle R_{\ell }^{m}(\mathbf {r} )}
   is a regular solid harmonic (a spherical harmonic times rℓ). We define the spherical multipole moment of the charge distribution as follows
          Q
            ℓ
            m
        ≡
          ∑
            i
            =
            1
            N
          q
            i
          R
            ℓ
            m
        (
            r
            i
        )
        ,
        −
        ℓ
        ≤
        m
        ≤
        ℓ
        .
    {\displaystyle Q_{\ell }^{m}\equiv \sum _{i=1}^{N}q_{i}R_{\ell }^{m}(\mathbf {r} _{i}),\qquad -\ell \leq m\leq \ell .}
Note that a multipole moment is solely determined by the charge distribution (the positions and magnitudes of the N charges).
A spherical harmonic depends on the unit vector 
              R
              ^
    {\displaystyle {\hat {R}}}
  . (A unit vector is determined by two spherical polar angles.) Thus, by definition, the irregular solid harmonics can be written as
          I
            ℓ
            m
        (
          R
        )
        ≡
                4
                π
                2
                ℓ
                +
                1
                Y
                  ℓ
                  m
              (
                    R
                    ^
              )
              R
                ℓ
                +
                1
    {\displaystyle I_{\ell }^{m}(\mathbf {R} )\equiv {\sqrt {\frac {4\pi }{2\ell +1}}}{\frac {Y_{\ell }^{m}({\hat {R}})}{R^{\ell +1}}}}
so that the multipole expansion of the field V(R) at the point R outside the charge distribution is given by
        V
        (
          R
        )
        =
            1
              4
              π
                ε
                  0
          ∑
            ℓ
            =
            0
            ∞
          ∑
            m
            =
            −
            ℓ
            ℓ
        (
        −
        1
          )
            m
          I
            ℓ
            −
            m
        (
          R
        )
          Q
            ℓ
            m
    {\displaystyle V(\mathbf {R} )={\frac {1}{4\pi \varepsilon _{0}}}\sum _{\ell =0}^{\infty }\sum _{m=-\ell }^{\ell }(-1)^{m}I_{\ell }^{-m}(\mathbf {R} )Q_{\ell }^{m}}
        =
            1
              4
              π
                ε
                  0
          ∑
            ℓ
            =
            0
            ∞
            [
                  4
                  π
                  2
                  ℓ
                  +
                  1
            ]
            1
              /
            2
            1
              R
                ℓ
                +
                1
          ∑
            m
            =
            −
            ℓ
            ℓ
        (
        −
        1
          )
            m
          Y
            ℓ
            −
            m
        (
              R
              ^
        )
          Q
            ℓ
            m
        ,
        R
        >
          r
              m
              a
              x
        .
    {\displaystyle ={\frac {1}{4\pi \varepsilon _{0}}}\sum _{\ell =0}^{\infty }\left[{\frac {4\pi }{2\ell +1}}\right]^{1/2}\;{\frac {1}{R^{\ell +1}}}\;\sum _{m=-\ell }^{\ell }(-1)^{m}Y_{\ell }^{-m}({\hat {R}})Q_{\ell }^{m},\qquad R>r_{\mathrm {max} }.}
This expansion is completely general in that it gives a closed form for all terms, not just for the first few. It shows that the spherical multipole moments appear as coefficients in the 1/R expansion of the potential.
It is of interest to consider the first few terms in real form, which are the only terms commonly found in undergraduate textbooks. Since the summand of the m summation is invariant under a unitary transformation of both factors simultaneously and since transformation of complex spherical harmonics to real form is by a unitary transformation, we can simply substitute real irregular solid harmonics and real multipole moments. The ℓ = 0 term becomes
          V
            ℓ
            =
            0
        (
          R
        )
        =
              q
                  t
                  o
                  t
              4
              π
                ε
                  0
              R
          with
          q
              t
              o
              t
        ≡
          ∑
            i
            =
            1
            N
          q
            i
        .
    {\displaystyle V_{\ell =0}(\mathbf {R} )={\frac {q_{\mathrm {tot} }}{4\pi \varepsilon _{0}R}}\qquad {\hbox{with}}\quad q_{\mathrm {tot} }\equiv \sum _{i=1}^{N}q_{i}.}
This is in fact Coulomb's law again. For the ℓ = 1 term we introduce
          R
        =
        (
          R
            x
        ,
          R
            y
        ,
          R
            z
        )
        ,
          P
        =
        (
          P
            x
        ,
          P
            y
        ,
          P
            z
        )
          with
          P
            α
        ≡
          ∑
            i
            =
            1
            N
          q
            i
          r
            i
            α
        ,
        α
        =
        x
        ,
        y
        ,
        z
        .
    {\displaystyle \mathbf {R} =(R_{x},R_{y},R_{z}),\quad \mathbf {P} =(P_{x},P_{y},P_{z})\quad {\hbox{with}}\quad P_{\alpha }\equiv \sum _{i=1}^{N}q_{i}r_{i\alpha },\quad \alpha =x,y,z.}
Then
          V
            ℓ
            =
            1
        (
          R
        )
        =
            1
              4
              π
                ε
                  0
                R
                  3
        (
          R
            x
          P
            x
        +
          R
            y
          P
            y
        +
          R
            z
          P
            z
        )
        =
                R
              ⋅
                P
              4
              π
                ε
                  0
                R
                  3
        =
                    R
                    ^
              ⋅
                P
              4
              π
                ε
                  0
                R
                  2
        .
    {\displaystyle V_{\ell =1}(\mathbf {R} )={\frac {1}{4\pi \varepsilon _{0}R^{3}}}(R_{x}P_{x}+R_{y}P_{y}+R_{z}P_{z})={\frac {\mathbf {R} \cdot \mathbf {P} }{4\pi \varepsilon _{0}R^{3}}}={\frac {{\hat {R}}\cdot \mathbf {P} }{4\pi \varepsilon _{0}R^{2}}}.}
This term is identical to the one found in Cartesian form.
In order to write the ℓ = 2 term, we have to introduce shorthand notations for the five real components of the quadrupole moment and the real spherical harmonics. Notations of the type
          Q
              z
                2
        ≡
          ∑
            i
            =
            1
            N
          q
            i
            1
            2
        (
        3
          z
            i
            2
        −
          r
            i
            2
        )
        ,
    {\displaystyle Q_{z^{2}}\equiv \sum _{i=1}^{N}q_{i}\;{\frac {1}{2}}(3z_{i}^{2}-r_{i}^{2}),}
can be found in the literature. Clearly the real notation becomes awkward very soon, exhibiting the usefulness of the complex notation.
Consider two sets of point charges, one set {qi } clustered around a point A and one set {qj } clustered around a point B. Think for example of two molecules, and recall that a molecule by definition consists of electrons (negative point charges) and nuclei (positive point charges). The total electrostatic interaction energy UAB between the two distributions is
          U
            A
            B
        =
          ∑
            i
            ∈
            A
          ∑
            j
            ∈
            B
                q
                  i
                q
                  j
              4
              π
                ε
                  0
                r
                  i
                  j
        .
    {\displaystyle U_{AB}=\sum _{i\in A}\sum _{j\in B}{\frac {q_{i}q_{j}}{4\pi \varepsilon _{0}r_{ij}}}.}
This energy can be expanded in a power series in the inverse distance of A and B. This expansion is known as the multipole expansion of UAB.
In order to derive this multipole expansion, we write rXY = rY-rX, which is a vector pointing from X towards Y. Note that
            R
            A
            B
        +
            r
            B
            j
        +
            r
            j
            i
        +
            r
            i
            A
        =
        0
        ⇔
            r
            i
            j
        =
            R
            A
            B
        −
            r
            A
            i
        +
            r
            B
            j
        .
    {\displaystyle \mathbf {R} _{AB}+\mathbf {r} _{Bj}+\mathbf {r} _{ji}+\mathbf {r} _{iA}=0\quad \Leftrightarrow \quad \mathbf {r} _{ij}=\mathbf {R} _{AB}-\mathbf {r} _{Ai}+\mathbf {r} _{Bj}.}
We assume that the two distributions do not overlap:
          |
            R
            A
            B
          |
        >
          |
            r
            B
            j
        −
            r
            A
            i
          |
          for all
        i
        ,
        j
        .
    {\displaystyle |\mathbf {R} _{AB}|>|\mathbf {r} _{Bj}-\mathbf {r} _{Ai}|\quad {\hbox{for all}}\quad i,j.}
Under this condition we may apply the Laplace expansion in the following form
            1
                |
                  r
                  j
              −
                  r
                  i
                |
        =
            1
                |
                  R
                  A
                  B
              −
              (
                  r
                  A
                  i
              −
                  r
                  B
                  j
              )
                |
        =
          ∑
            L
            =
            0
            ∞
          ∑
            M
            =
            −
            L
            L
        (
        −
        1
          )
            M
          I
            L
            −
            M
        (
            R
            A
            B
        )
          R
            L
            M
        (
            r
            A
            i
        −
            r
            B
            j
        )
        ,
    {\displaystyle {\frac {1}{|\mathbf {r} _{j}-\mathbf {r} _{i}|}}={\frac {1}{|\mathbf {R} _{AB}-(\mathbf {r} _{Ai}-\mathbf {r} _{Bj})|}}=\sum _{L=0}^{\infty }\sum _{M=-L}^{L}\,(-1)^{M}I_{L}^{-M}(\mathbf {R} _{AB})\;R_{L}^{M}(\mathbf {r} _{Ai}-\mathbf {r} _{Bj}),}
where 
          I
            L
            M
    {\displaystyle I_{L}^{M}}
   and 
          R
            L
            M
    {\displaystyle R_{L}^{M}}
   are irregular and regular solid harmonics, respectively. The translation of the regular solid harmonic gives a finite expansion,
          R
            L
            M
        (
            r
            A
            i
        −
            r
            B
            j
        )
        =
          ∑
              ℓ
                A
            =
            0
            L
        (
        −
        1
          )
            L
            −
              ℓ
                A
                (
                  2
                  L
                  2
                    ℓ
                      A
                )
            1
              /
            2
    {\displaystyle R_{L}^{M}(\mathbf {r} _{Ai}-\mathbf {r} _{Bj})=\sum _{\ell _{A}=0}^{L}(-1)^{L-\ell _{A}}{\binom {2L}{2\ell _{A}}}^{1/2}}
        ×
          ∑
              m
                A
            =
            −
              ℓ
                A
              ℓ
                A
          R
              ℓ
                A
              m
                A
        (
            r
            A
            i
        )
          R
            L
            −
              ℓ
                A
            M
            −
              m
                A
        (
            r
            B
            j
        )
        ⟨
          ℓ
            A
        ,
          m
            A
        ;
        L
        −
          ℓ
            A
        ,
        M
        −
          m
            A
          |
        L
        M
        ⟩
        ,
    {\displaystyle \times \sum _{m_{A}=-\ell _{A}}^{\ell _{A}}R_{\ell _{A}}^{m_{A}}(\mathbf {r} _{Ai})R_{L-\ell _{A}}^{M-m_{A}}(\mathbf {r} _{Bj})\;\langle \ell _{A},m_{A};L-\ell _{A},M-m_{A}|LM\rangle ,}
where the quantity between pointed brackets is a Clebsch-Gordan coefficient. Further we used
          R
            ℓ
            m
        (
        −
          r
        )
        =
        (
        −
        1
          )
            ℓ
          R
            ℓ
            m
        (
          r
        )
        .
    {\displaystyle R_{\ell }^{m}(-\mathbf {r} )=(-1)^{\ell }R_{\ell }^{m}(\mathbf {r} ).}
Use of the definition of spherical multipoles Qml and covering of the summation ranges in a somewhat different order (which is only allowed for an infinite range of L) gives finally
          U
            A
            B
        =
            1
              4
              π
                ε
                  0
          ∑
              ℓ
                A
            =
            0
            ∞
          ∑
              ℓ
                B
            =
            0
            ∞
        (
        −
        1
          )
              ℓ
                B
                (
                  2
                    ℓ
                      A
                  +
                  2
                    ℓ
                      B
                  2
                    ℓ
                      A
                )
            1
              /
            2
    {\displaystyle U_{AB}={\frac {1}{4\pi \varepsilon _{0}}}\sum _{\ell _{A}=0}^{\infty }\sum _{\ell _{B}=0}^{\infty }(-1)^{\ell _{B}}{\binom {2\ell _{A}+2\ell _{B}}{2\ell _{A}}}^{1/2}\,}
        ×
          ∑
              m
                A
            =
            −
              ℓ
                A
              ℓ
                A
          ∑
              m
                B
            =
            −
              ℓ
                B
              ℓ
                B
        (
        −
        1
          )
              m
                A
            +
              m
                B
          I
              ℓ
                A
            +
              ℓ
                B
            −
              m
                A
            −
              m
                B
        (
            R
            A
            B
        )
          Q
              ℓ
                A
              m
                A
          Q
              ℓ
                B
              m
                B
        ⟨
          ℓ
            A
        ,
          m
            A
        ;
          ℓ
            B
        ,
          m
            B
          |
          ℓ
            A
        +
          ℓ
            B
        ,
          m
            A
        +
          m
            B
        ⟩
        .
    {\displaystyle \times \sum _{m_{A}=-\ell _{A}}^{\ell _{A}}\sum _{m_{B}=-\ell _{B}}^{\ell _{B}}(-1)^{m_{A}+m_{B}}I_{\ell _{A}+\ell _{B}}^{-m_{A}-m_{B}}(\mathbf {R} _{AB})\;Q_{\ell _{A}}^{m_{A}}Q_{\ell _{B}}^{m_{B}}\;\langle \ell _{A},m_{A};\ell _{B},m_{B}|\ell _{A}+\ell _{B},m_{A}+m_{B}\rangle .}
This is the multipole expansion of the interaction energy of two non-overlapping charge distributions which are a distance RAB apart. Since
          I
              ℓ
                A
            +
              ℓ
                B
            −
            (
              m
                A
            +
              m
                B
            )
        (
            R
            A
            B
        )
        ≡
            [
                  4
                  π
                  2
                    ℓ
                      A
                  +
                  2
                    ℓ
                      B
                  +
                  1
            ]
            1
              /
            2
                Y
                    ℓ
                      A
                  +
                    ℓ
                      B
                  −
                  (
                    m
                      A
                  +
                    m
                      B
                  )
              (
                        R
                      ^
                  A
                  B
              )
              R
                A
                B
                  ℓ
                    A
                +
                  ℓ
                    B
                +
                1
    {\displaystyle I_{\ell _{A}+\ell _{B}}^{-(m_{A}+m_{B})}(\mathbf {R} _{AB})\equiv \left[{\frac {4\pi }{2\ell _{A}+2\ell _{B}+1}}\right]^{1/2}\;{\frac {Y_{\ell _{A}+\ell _{B}}^{-(m_{A}+m_{B})}({\widehat {\mathbf {R} }}_{AB})}{R_{AB}^{\ell _{A}+\ell _{B}+1}}}}
this expansion is manifestly in powers of 1/RAB. The function Yml is a normalized spherical harmonic.
All atoms and molecules (except S-state atoms) have one or more non-vanishing permanent multipole moments. Different definitions can be found in the literature, but the following definition in spherical form has the advantage that it is contained in one general equation. Because it is in complex form it has as the further advantage that it is easier to manipulate in calculations than its real counterpart.
We consider a molecule consisting of N particles (electrons and nuclei) with charges eZi. (Electrons have the Z-value unity, for nuclei it is the atomic number). Particle i has spherical polar coordinates ri, θi, and φi and Cartesian coordinates xi, yi, and zi. The (complex) electrostatic multipole operator is
          Q
            ℓ
            m
        ≡
          ∑
            i
            =
            1
            N
        e
          Z
            i
          R
            ℓ
            m
        (
            r
            i
        )
        ,
    {\displaystyle Q_{\ell }^{m}\equiv \sum _{i=1}^{N}eZ_{i}\;R_{\ell }^{m}(\mathbf {r} _{i}),}
where 
          R
            ℓ
            m
        (
            r
            i
        )
    {\displaystyle R_{\ell }^{m}(\mathbf {r} _{i})}
   is a regular solid harmonic function in Racah's normalization (also known as Schmidt's semi-normalization). If the molecule has total normalized wave function Ψ (depending on the coordinates of electrons and nuclei), then the multipole moment of order 
        ℓ
    {\displaystyle \ell }
   of the molecule is given by the expectation (expected) value:
          M
            ℓ
            m
        ≡
        ⟨
        Ψ
          |
          Q
            ℓ
            m
          |
        Ψ
        ⟩
        .
    {\displaystyle M_{\ell }^{m}\equiv \langle \Psi |Q_{\ell }^{m}|\Psi \rangle .}
If the molecule has certain point group symmetry, then this is reflected in the wave function: Ψ transforms according to a certain irreducible representation λ of the group ("Ψ has symmetry type λ"). This has the consequence that selection rules hold for the expectation value of the multipole operator, or in other words, that the expectation value may vanish because of symmetry. A well-known example of this is the fact that molecules with an inversion center do not carry a dipole (the expectation values of 
          Q
            1
            m
    {\displaystyle Q_{1}^{m}}
   vanish for m = −1, 0, 1). For a molecule without symmetry no selection rules are operative and such a molecule will have non-vanishing multipoles of any order (it will carry a dipole and simultaneously a quadrupole, octupole, hexadecapole, etc.).
The lowest explicit forms of the regular solid harmonics (with the Condon-Shortley phase) give:
          M
            0
            0
        =
          ∑
            i
            =
            1
            N
        e
          Z
            i
        ,
    {\displaystyle M_{0}^{0}=\sum _{i=1}^{N}eZ_{i},}
(the total charge of the molecule). The (complex) dipole components are:
          M
            1
            1
        =
        −
                1
                2
          ∑
            i
            =
            1
            N
        e
          Z
            i
        ⟨
        Ψ
          |
          x
            i
        +
        i
          y
            i
          |
        Ψ
        ⟩
          and
          M
            1
            −
            1
        =
                1
                2
          ∑
            i
            =
            1
            N
        e
          Z
            i
        ⟨
        Ψ
          |
          x
            i
        −
        i
          y
            i
          |
        Ψ
        ⟩
        .
    {\displaystyle M_{1}^{1}=-{\sqrt {\tfrac {1}{2}}}\sum _{i=1}^{N}eZ_{i}\langle \Psi |x_{i}+iy_{i}|\Psi \rangle \quad {\hbox{and}}\quad M_{1}^{-1}={\sqrt {\tfrac {1}{2}}}\sum _{i=1}^{N}eZ_{i}\langle \Psi |x_{i}-iy_{i}|\Psi \rangle .}
          M
            1
            0
        =
          ∑
            i
            =
            1
            N
        e
          Z
            i
        ⟨
        Ψ
          |
          z
            i
          |
        Ψ
        ⟩
        .
    {\displaystyle M_{1}^{0}=\sum _{i=1}^{N}eZ_{i}\langle \Psi |z_{i}|\Psi \rangle .}
Note that by a simple linear combination one can transform the complex multipole operators to real ones. The real multipole operators are of cosine type 
          C
            ℓ
            m
    {\displaystyle C_{\ell }^{m}}
   or sine type 
          S
            ℓ
            m
    {\displaystyle S_{\ell }^{m}}
  . A few of the lowest ones are:
                  C
                    1
                    0
                =
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  z
                    i
                  C
                    1
                    1
                =
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  x
                    i
                  S
                    1
                    1
                =
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  y
                    i
                  C
                    2
                    0
                =
                    1
                    2
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                (
                3
                  z
                    i
                    2
                −
                  r
                    i
                    2
                )
                  C
                    2
                    1
                =
                    3
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  z
                    i
                  x
                    i
                  C
                    2
                    2
                =
                    1
                    3
                    3
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                (
                  x
                    i
                    2
                −
                  y
                    i
                    2
                )
                  S
                    2
                    1
                =
                    3
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  z
                    i
                  y
                    i
                  S
                    2
                    2
                =
                    2
                    3
                    3
                  ∑
                    i
                    =
                    1
                    N
                e
                  Z
                    i
                  x
                    i
                  y
                    i
    {\displaystyle {\begin{aligned}C_{1}^{0}&=\sum _{i=1}^{N}eZ_{i}\;z_{i}\\C_{1}^{1}&=\sum _{i=1}^{N}eZ_{i}\;x_{i}\\S_{1}^{1}&=\sum _{i=1}^{N}eZ_{i}\;y_{i}\\C_{2}^{0}&={\frac {1}{2}}\sum _{i=1}^{N}eZ_{i}\;(3z_{i}^{2}-r_{i}^{2})\\C_{2}^{1}&={\sqrt {3}}\sum _{i=1}^{N}eZ_{i}\;z_{i}x_{i}\\C_{2}^{2}&={\frac {1}{3}}{\sqrt {3}}\sum _{i=1}^{N}eZ_{i}\;(x_{i}^{2}-y_{i}^{2})\\S_{2}^{1}&={\sqrt {3}}\sum _{i=1}^{N}eZ_{i}\;z_{i}y_{i}\\S_{2}^{2}&={\frac {2}{3}}{\sqrt {3}}\sum _{i=1}^{N}eZ_{i}\;x_{i}y_{i}\\\end{aligned}}}
The definition of the complex molecular multipole moment given above is the complex conjugate of the definition given in this article, which follows the definition of the standard textbook on classical electrodynamics by Jackson, except for the normalization. Moreover, in the classical definition of Jackson the equivalent of the N-particle quantum mechanical expectation value is an integral over a one-particle charge distribution. Remember that in the case of a one-particle quantum mechanical system the expectation value is nothing but an integral over the charge distribution (modulus of wavefunction squared), so that the definition of this article is a quantum mechanical N-particle generalization of Jackson's definition.
The definition in this article agrees with, among others, the one of Fano and Racah and Brink and Satchler.
There are many types of multipole moments, since there are many types of potentials and many ways of approximating a potential by a series expansion, depending on the coordinates and the symmetry of the charge distribution. The most common expansions include:
Axial multipole moments of a 1/R potential;
Spherical multipole moments of a 1/R potential; and
Cylindrical multipole moments of a ln R potential
Examples of 1/R potentials include the electric potential, the magnetic potential and the gravitational potential of point sources. An example of a ln R potential is the electric potential of an infinite line charge.
Multipole moments in mathematics and mathematical physics form an orthogonal basis for the decomposition of a function, based on the response of a field to point sources that are brought infinitely close to each other. These can be thought of as arranged in various geometrical shapes, or, in the sense of distribution theory, as directional derivatives.
Multipole expansions are related to the underlying rotational symmetry of the physical laws and their associated differential equations. Even though the source terms (such as the masses, charges, or currents) may not be symmetrical, one can expand them in terms of irreducible representations of the rotational symmetry group, which leads to spherical harmonics and related sets of orthogonal functions. One uses the technique of separation of variables to extract the corresponding solutions for the radial dependencies.
In practice, many fields can be well approximated with a finite number of multipole moments (although an infinite number may be required to reconstruct a field exactly). A typical application is to approximate the field of a localized charge distribution by its monopole and dipole terms. Problems solved once for a given order of multipole moment may be linearly combined to create a final approximate solution for a given source.
Barnes–Hut simulation
Laplace expansion
Legendre polynomials
Quadrupole magnets are used in particle accelerators
Solid harmonics
Toroidal moment
