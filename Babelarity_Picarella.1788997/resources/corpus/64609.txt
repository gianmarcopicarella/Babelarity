In calculus, and more generally in mathematical analysis, integration by parts or partial integration is a theorem that relates the integral of a product of functions to the integral of their derivative and antiderivative. It is frequently used to transform the antiderivative of a product of functions into an antiderivative for which a solution can be more easily found. The rule can be derived in one line simply by integrating the product rule of differentiation.
If u = u(x) and du = u′(x) dx, while v = v(x) and dv = v′(x) dx, then integration by parts states that:
        ∫
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
        =
        u
        (
        x
        )
        v
        (
        x
        )
        −
        ∫
        v
        (
        x
        )
          u
          ′
        (
        x
        )
        d
        x
    {\displaystyle \int u(x)v'(x)\,dx=u(x)v(x)-\int v(x)\,u'(x)dx}
or more compactly:
        ∫
        u
        d
        v
        =
        u
        v
        −
        ∫
        v
        d
        u
        .
    {\displaystyle \int u\,dv=uv-\int v\,du.\!}
More general formulations of integration by parts exist for the Riemann–Stieltjes and Lebesgue–Stieltjes integrals. The discrete analogue for sequences is called summation by parts.
The theorem can be derived as follows. Suppose u(x) and v(x) are two continuously differentiable functions. The product rule states (in Leibniz's notation):
            d
              d
              x
            (
        u
        (
        x
        )
        v
        (
        x
        )
            )
        =
        v
        (
        x
        )
            d
              d
              x
          (
          u
          (
          x
          )
          )
        +
        u
        (
        x
        )
            d
              d
              x
          (
          v
          (
          x
          )
          )
        .
    {\displaystyle {\frac {d}{dx}}{\Big (}u(x)v(x){\Big )}=v(x){\frac {d}{dx}}\left(u(x)\right)+u(x){\frac {d}{dx}}\left(v(x)\right).\!}
Integrating both sides with respect to x,
        ∫
            d
              d
              x
          (
          u
          (
          x
          )
          v
          (
          x
          )
          )
        d
        x
        =
        ∫
          u
          ′
        (
        x
        )
        v
        (
        x
        )
        d
        x
        +
        ∫
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
    {\displaystyle \int {\frac {d}{dx}}\left(u(x)v(x)\right)\,dx=\int u'(x)v(x)\,dx+\int u(x)v'(x)\,dx}
then applying the definition of indefinite integral,
        u
        (
        x
        )
        v
        (
        x
        )
        =
        ∫
          u
          ′
        (
        x
        )
        v
        (
        x
        )
        d
        x
        +
        ∫
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
    {\displaystyle u(x)v(x)=\int u'(x)v(x)\,dx+\int u(x)v'(x)\,dx}
        ∫
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
        =
        u
        (
        x
        )
        v
        (
        x
        )
        −
        ∫
          u
          ′
        (
        x
        )
        v
        (
        x
        )
        d
        x
    {\displaystyle \int u(x)v'(x)\,dx=u(x)v(x)-\int u'(x)v(x)\,dx}
gives the formula for integration by parts.
Since du and dv are differentials of a function of one variable x,
        d
        u
        =
          u
          ′
        (
        x
        )
        d
        x
        d
        v
        =
          v
          ′
        (
        x
        )
        d
        x
    {\displaystyle du=u'(x)dx\quad dv=v'(x)dx}
        ∫
        u
        (
        x
        )
        d
        v
        =
        u
        (
        x
        )
        v
        (
        x
        )
        −
        ∫
        v
        (
        x
        )
        d
        u
    {\displaystyle \int u(x)\,dv=u(x)v(x)-\int v(x)\,du}
The original integral ∫uv′ dx contains v′ (derivative of v); in order to apply the theorem, v (antiderivative of v′) must be found, and then the resulting integral ∫vu′ dx must be evaluated.
It is not actually necessary for u and v to be continuously differentiable. Integration by parts works if u is absolutely continuous and the function designated v' is Lebesgue integrable (but not necessarily continuous). (If v' has a point of discontinuity then its antiderivative v may not have a derivative at that point.)
If the interval of integration is not compact, then it is not necessary for u to be absolutely continuous in the whole interval or for v ' to be Lebesgue integrable in the interval, as a couple of examples (in which u and v are continuous and continuously differentiable) will show. For instance, if
        u
        (
        x
        )
        =
        exp
        ⁡
        (
        x
        )
          /
          x
            2
        ,
          v
          ′
        (
        x
        )
        =
        exp
        ⁡
        (
        −
        x
        )
    {\displaystyle u(x)=\exp(x)/x^{2},\,v'(x)=\exp(-x)}
u is not absolutely continuous on the interval [1, +∞), but nevertheless
          ∫
            1
            ∞
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
        =
            [
            u
            (
            x
            )
            v
            (
            x
            )
            ]
            1
            ∞
        −
          ∫
            1
            ∞
          u
          ′
        (
        x
        )
        v
        (
        x
        )
        d
        x
    {\displaystyle \int _{1}^{\infty }u(x)v'(x)\,dx=\left[u(x)v(x)\right]_{1}^{\infty }-\int _{1}^{\infty }u'(x)v(x)\,dx}
so long as 
            [
            u
            (
            x
            )
            v
            (
            x
            )
            ]
            1
            ∞
    {\displaystyle \left[u(x)v(x)\right]_{1}^{\infty }}
   is taken to mean the limit of 
        u
        (
        L
        )
        v
        (
        L
        )
        −
        u
        (
        1
        )
        v
        (
        1
        )
    {\displaystyle u(L)v(L)-u(1)v(1)}
   as 
        L
        →
        ∞
    {\displaystyle L\to \infty }
   and so long as the two terms on the right-hand side are finite. This is only true if we choose 
        v
        (
        x
        )
        =
        −
        exp
        ⁡
        (
        −
        x
        )
        .
    {\displaystyle v(x)=-\exp(-x).}
   Similarly, if
        u
        (
        x
        )
        =
        exp
        ⁡
        (
        −
        x
        )
        ,
          v
          ′
        (
        x
        )
        =
          x
            −
            1
        sin
        ⁡
        (
        x
        )
    {\displaystyle u(x)=\exp(-x),\,v'(x)=x^{-1}\sin(x)}
v' is not Lebesgue integrable on the interval [1, +∞), but nevertheless
          ∫
            1
            ∞
        u
        (
        x
        )
          v
          ′
        (
        x
        )
        d
        x
        =
            [
            u
            (
            x
            )
            v
            (
            x
            )
            ]
            1
            ∞
        −
          ∫
            1
            ∞
          u
          ′
        (
        x
        )
        v
        (
        x
        )
        d
        x
    {\displaystyle \int _{1}^{\infty }u(x)v'(x)\,dx=\left[u(x)v(x)\right]_{1}^{\infty }-\int _{1}^{\infty }u'(x)v(x)\,dx}
with the same interpretation.
One can also easily come up with similar examples in which u and v are not continuously differentiable.
Integrating the product rule for three multiplied functions, u(x), v(x), w(x), gives a similar result:
          ∫
            a
            b
        u
        v
        d
        w
        =
        [
        u
        v
        w
          ]
            a
            b
        −
          ∫
            a
            b
        u
        w
        d
        v
        −
          ∫
            a
            b
        v
        w
        d
        u
        .
    {\displaystyle \int _{a}^{b}uv\,dw=[uvw]_{a}^{b}-\int _{a}^{b}uw\,dv-\int _{a}^{b}vw\,du.}
In general, for n factors
            d
              d
              x
          (
            ∏
              i
              =
              1
              n
            u
              i
          (
          x
          )
          )
        =
          ∑
            j
            =
            1
            n
          ∏
            i
            ≠
            j
            n
          u
            i
        (
        x
        )
              d
                u
                  j
              (
              x
              )
              d
              x
        ,
    {\displaystyle {\frac {d}{dx}}\left(\prod _{i=1}^{n}u_{i}(x)\right)=\sum _{j=1}^{n}\prod _{i\neq j}^{n}u_{i}(x){\frac {du_{j}(x)}{dx}},}
which leads to
            [
          ∏
            i
            =
            1
            n
          u
            i
        (
        x
        )
              ]
            a
            b
        =
          ∑
            j
            =
            1
            n
          ∫
            a
            b
          ∏
            i
            ≠
            j
            n
          u
            i
        (
        x
        )
        d
          u
            j
        (
        x
        )
        ,
    {\displaystyle {\Bigl [}\prod _{i=1}^{n}u_{i}(x){\Bigr ]}_{a}^{b}=\sum _{j=1}^{n}\int _{a}^{b}\prod _{i\neq j}^{n}u_{i}(x)\,du_{j}(x),}
where the product is of all functions except for the one differentiated in the same term.
Define a parametric curve by (x, y) = (f(t), g(t)). Assuming that the curve is locally one-to-one, we can define
        x
        (
        y
        )
        =
        f
        (
          g
            −
            1
        (
        y
        )
        )
    {\displaystyle x(y)=f(g^{-1}(y))}
        y
        (
        x
        )
        =
        g
        (
          f
            −
            1
        (
        x
        )
        )
    {\displaystyle y(x)=g(f^{-1}(x))}
The area of the blue region is
          A
            1
        =
          ∫
              y
                1
              y
                2
        x
        (
        y
        )
        d
        y
    {\displaystyle A_{1}=\int _{y_{1}}^{y_{2}}x(y)dy}
Similarly, the area of the red region is
          A
            2
        =
          ∫
              x
                1
              x
                2
        y
        (
        x
        )
        d
        x
    {\displaystyle A_{2}=\int _{x_{1}}^{x_{2}}y(x)dx}
The total area A1 + A2 is equal to the area of the bigger rectangle, x2y2, minus the area of the smaller one, x1y1:
                  ∫
                      y
                        1
                      y
                        2
                x
                (
                y
                )
                d
                y
              ⏞
              A
                1
        +
                  ∫
                      x
                        1
                      x
                        2
                y
                (
                x
                )
                d
                x
              ⏞
              A
                2
        =
        x
        .
        y
        (
        x
        )
              |
            x
            1
            x
            2
        =
        y
        .
        x
        (
        y
        )
              |
            y
            1
            y
            2
    {\displaystyle \overbrace {\int _{y_{1}}^{y_{2}}x(y)dy} ^{A_{1}}+\overbrace {\int _{x_{1}}^{x_{2}}y(x)dx} ^{A_{2}}={\biggl .}x.y(x){\biggl |}_{x1}^{x2}={\biggl .}y.x(y){\biggl |}_{y1}^{y2}}
Assuming the curve is smooth within a neighborhood, this generalizes to indefinite integrals:
        ∫
        x
        d
        y
        +
        ∫
        y
        d
        x
        =
        x
        y
    {\displaystyle \int xdy+\int ydx=xy}
Rearranging:
        ∫
        x
        d
        y
        =
        x
        y
        −
        ∫
        y
        d
        x
    {\displaystyle \int xdy=xy-\int ydx}
Thus integration by parts may be thought of as deriving the area of the blue region from the total area and that of the red region.
This visualisation also explains why integration by parts may help find the integral of an inverse function f−1(x) when the integral of the function f(xv) is known. Indeed, the functions x(y) and y(x) are inverses, and the integral ∫x dy may be calculated as above from knowing the integral ∫y dx.
Integration by parts is a heuristic rather than a purely mechanical process for solving integrals; given a single function to integrate, the typical strategy is to carefully separate it into a product of two functions u(x)v(x) such that the integral produced by the integration by parts formula is easier to evaluate than the original one. The following form is useful in illustrating the best strategy to take:
        ∫
        u
        v
        d
        x
        =
        u
        ∫
        v
        d
        x
        −
        ∫
          (
            u
            ′
          ∫
          v
          d
          x
          )
        d
        x
        .
    {\displaystyle \int uv\ dx=u\int v\ dx-\int \left(u'\int v\ dx\right)\ dx.}
Note that on the right-hand side, u is differentiated and v is integrated; consequently it is useful to choose u as a function that simplifies when differentiated, or to choose v as a function that simplifies when integrated. As a simple example, consider:
        ∫
              ln
              ⁡
              (
              x
              )
              x
                2
        d
        x
        .
    {\displaystyle \int {\frac {\ln(x)}{x^{2}}}\ dx\ .}
Since the derivative of ln(x) is 1/x, one makes (ln(x)) part u; since the antiderivative of 1/x2 is -1/x, one makes 1/x2dx part dv. The formula now yields:
        ∫
              ln
              ⁡
              (
              x
              )
              x
                2
        d
        x
        =
        −
              ln
              ⁡
              (
              x
              )
            x
        −
        ∫
            (
            1
            x
            )
            (
        −
            1
            x
            )
        d
        x
        .
    {\displaystyle \int {\frac {\ln(x)}{x^{2}}}\ dx=-{\frac {\ln(x)}{x}}-\int {\biggl (}{\frac {1}{x}}{\biggr )}{\biggl (}-{\frac {1}{x}}{\biggr )}\ dx\ .}
The antiderivative of −1/x2 can be found with the power rule and is 1/x.
Alternatively, one may choose u and v such that the product u' (∫v dx) simplifies due to cancellation. For example, suppose one wishes to integrate:
        ∫
          sec
            2
        ⁡
        (
        x
        )
        ⋅
        ln
        ⁡
            (
            |
        sin
        ⁡
        (
        x
        )
            |
            )
        d
        x
        .
    {\displaystyle \int \sec ^{2}(x)\cdot \ln {\Big (}{\bigl |}\sin(x){\bigr |}{\Big )}\ dx.}
If we choose u(x) = ln(|sin(x)|) and v(x) = sec2x, then u differentiates to 1/ tan x using the chain rule and v integrates to tan x; so the formula gives:
        ∫
          sec
            2
        ⁡
        (
        x
        )
        ⋅
        ln
        ⁡
            (
            |
        sin
        ⁡
        (
        x
        )
            |
            )
        d
        x
        =
        tan
        ⁡
        (
        x
        )
        ⋅
        ln
        ⁡
            (
            |
        sin
        ⁡
        (
        x
        )
            |
            )
        −
        ∫
        tan
        ⁡
        (
        x
        )
        ⋅
            1
              tan
              ⁡
              (
              x
              )
        d
        x
        .
    {\displaystyle \int \sec ^{2}(x)\cdot \ln {\Big (}{\bigl |}\sin(x){\bigr |}{\Big )}\ dx=\tan(x)\cdot \ln {\Big (}{\bigl |}\sin(x){\bigr |}{\Big )}-\int \tan(x)\cdot {\frac {1}{\tan(x)}}dx\ .}
The integrand simplifies to 1, so the antiderivative is x. Finding a simplifying combination frequently involves experimentation.
In some applications, it may not be necessary to ensure that the integral produced by integration by parts has a simple form; for example, in numerical analysis, it may suffice that it has small magnitude and so contributes only a small error term. Some other special techniques are demonstrated in the examples below.
Polynomials and trigonometric functions
In order to calculate
        I
        =
        ∫
        x
        cos
        ⁡
        (
        x
        )
        d
        x
        ,
    {\displaystyle I=\int x\cos(x)\ dx\ ,}
let:
        u
        =
        x
        ⇒
        d
        u
        =
        d
        x
    {\displaystyle u=x\ \Rightarrow \ du=dx}
        d
        v
        =
        cos
        ⁡
        (
        x
        )
        d
        x
        ⇒
        v
        =
        ∫
        cos
        ⁡
        (
        x
        )
        d
        x
        =
        sin
        ⁡
        (
        x
        )
    {\displaystyle dv=\cos(x)\ dx\ \Rightarrow \ v=\int \cos(x)\ dx=\sin(x)}
then:
                ∫
                x
                cos
                ⁡
                (
                x
                )
                d
                x
                =
                ∫
                u
                d
                v
                =
                u
                ⋅
                v
                −
                ∫
                v
                d
                u
                =
                x
                sin
                ⁡
                (
                x
                )
                −
                ∫
                sin
                ⁡
                (
                x
                )
                d
                x
                =
                x
                sin
                ⁡
                (
                x
                )
                +
                cos
                ⁡
                (
                x
                )
                +
                C
                ,
    {\displaystyle {\begin{aligned}\int x\cos(x)\ dx&=\int u\ dv\\&=u\cdot v-\int v\,du\\&=x\sin(x)-\int \sin(x)\ dx\\&=x\sin(x)+\cos(x)+C,\end{aligned}}\!}
where C is a constant of integration.
For higher powers of x in the form
        ∫
          x
            n
          e
            x
        d
        x
        ,
        ∫
          x
            n
        sin
        ⁡
        (
        x
        )
        d
        x
        ,
        ∫
          x
            n
        cos
        ⁡
        (
        x
        )
        d
        x
        ,
    {\displaystyle \int x^{n}e^{x}\ dx,\ \int x^{n}\sin(x)\ dx,\ \int x^{n}\cos(x)\ dx\ ,}
repeatedly using integration by parts can evaluate integrals such as these; each application of the theorem lowers the power of x by one.
Exponentials and trigonometric functions
An example commonly used to examine the workings of integration by parts is
        I
        =
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle I=\int e^{x}\cos(x)\ dx.}
Here, integration by parts is performed twice. First let
        u
        =
        cos
        ⁡
        (
        x
        )
        ⇒
        d
        u
        =
        −
        sin
        ⁡
        (
        x
        )
        d
        x
    {\displaystyle u=\cos(x)\ \Rightarrow \ du=-\sin(x)\ dx}
        d
        v
        =
          e
            x
        d
        x
        ⇒
        v
        =
        ∫
          e
            x
        d
        x
        =
          e
            x
    {\displaystyle dv=e^{x}\ dx\ \Rightarrow \ v=\int e^{x}\ dx=e^{x}}
then:
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        =
          e
            x
        cos
        ⁡
        (
        x
        )
        +
        ∫
          e
            x
        sin
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle \int e^{x}\cos(x)\ dx=e^{x}\cos(x)+\int e^{x}\sin(x)\ dx.}
Now, to evaluate the remaining integral, we use integration by parts again, with:
        u
        =
        sin
        ⁡
        (
        x
        )
        ⇒
        d
        u
        =
        cos
        ⁡
        (
        x
        )
        d
        x
    {\displaystyle u=\sin(x)\ \Rightarrow \ du=\cos(x)\ dx}
        d
        v
        =
          e
            x
        d
        x
        ⇒
        v
        =
        ∫
          e
            x
        d
        x
        =
          e
            x
        .
    {\displaystyle dv=e^{x}\ dx\ \Rightarrow \ v=\int e^{x}\ dx=e^{x}.}
Then:
        ∫
          e
            x
        sin
        ⁡
        (
        x
        )
        d
        x
        =
          e
            x
        sin
        ⁡
        (
        x
        )
        −
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle \int e^{x}\sin(x)\ dx=e^{x}\sin(x)-\int e^{x}\cos(x)\ dx.}
Putting these together,
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        =
          e
            x
        cos
        ⁡
        (
        x
        )
        +
          e
            x
        sin
        ⁡
        (
        x
        )
        −
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle \int e^{x}\cos(x)\ dx=e^{x}\cos(x)+e^{x}\sin(x)-\int e^{x}\cos(x)\ dx.}
The same integral shows up on both sides of this equation. The integral can simply be added to both sides to get
        2
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        =
          e
            x
            (
        sin
        ⁡
        (
        x
        )
        +
        cos
        ⁡
        (
        x
        )
            )
        +
        C
    {\displaystyle 2\int e^{x}\cos(x)\ dx=e^{x}{\bigl (}\sin(x)+\cos(x){\bigr )}+C}
which rearranges to:
        ∫
          e
            x
        cos
        ⁡
        (
        x
        )
        d
        x
        =
                e
                  x
                  (
              sin
              ⁡
              (
              x
              )
              +
              cos
              ⁡
              (
              x
              )
                  )
            2
        +
          C
          ′
    {\displaystyle \int e^{x}\cos(x)\ dx={\frac {e^{x}{\bigl (}\sin(x)+\cos(x){\bigr )}}{2}}+C'}
where again C (and C' = C/2) is a constant of integration.
A similar method is used to find the integral of secant cubed.
Functions multiplied by unity
Two other well-known examples are when integration by parts is applied to a function expressed as a product of 1 and itself. This works if the derivative of the function is known, and the integral of this derivative times x is also known.
The first example is ∫ ln(x) dx. We write this as:
        I
        =
        ∫
        ln
        ⁡
        (
        x
        )
        ⋅
        1
        d
        x
        .
    {\displaystyle I=\int \ln(x)\cdot 1\ dx\ .}
Let:
        u
        =
        ln
        ⁡
        (
        x
        )
        ⇒
        d
        u
        =
              d
              x
            x
    {\displaystyle u=\ln(x)\ \Rightarrow \ du={\frac {dx}{x}}}
        d
        v
        =
        d
        x
        ⇒
        v
        =
        x
    {\displaystyle dv=dx\ \Rightarrow \ v=x}
then:
                ∫
                ln
                ⁡
                (
                x
                )
                d
                x
                =
                x
                ln
                ⁡
                (
                x
                )
                −
                ∫
                    x
                    x
                d
                x
                =
                x
                ln
                ⁡
                (
                x
                )
                −
                ∫
                1
                d
                x
                =
                x
                ln
                ⁡
                (
                x
                )
                −
                x
                +
                C
    {\displaystyle {\begin{aligned}\int \ln(x)\ dx&=x\ln(x)-\int {\frac {x}{x}}\ dx\\&=x\ln(x)-\int 1\ dx\\&=x\ln(x)-x+C\end{aligned}}}
where C is the constant of integration.
The second example is the inverse tangent function arctan(x):
        I
        =
        ∫
        arctan
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle I=\int \arctan(x)\ dx.}
Rewrite this as
        ∫
        arctan
        ⁡
        (
        x
        )
        ⋅
        1
        d
        x
        .
    {\displaystyle \int \arctan(x)\cdot 1\ dx.}
Now let:
        u
        =
        arctan
        ⁡
        (
        x
        )
        ⇒
        d
        u
        =
              d
              x
              1
              +
                x
                  2
    {\displaystyle u=\arctan(x)\ \Rightarrow \ du={\frac {dx}{1+x^{2}}}}
        d
        v
        =
        d
        x
        ⇒
        v
        =
        x
    {\displaystyle dv=dx\ \Rightarrow \ v=x}
then
                ∫
                arctan
                ⁡
                (
                x
                )
                d
                x
                =
                x
                ⋅
                arctan
                ⁡
                (
                x
                )
                −
                ∫
                    x
                      1
                      +
                        x
                          2
                d
                x
                =
                x
                ⋅
                arctan
                ⁡
                (
                x
                )
                −
                      ln
                      ⁡
                      (
                      1
                      +
                        x
                          2
                      )
                    2
                +
                C
    {\displaystyle {\begin{aligned}\int \arctan(x)\ dx&=x\cdot \arctan(x)-\int {\frac {x}{1+x^{2}}}\ dx\\[8pt]&=x\cdot \arctan(x)-{\frac {\ln(1+x^{2})}{2}}+C\end{aligned}}}
using a combination of the inverse chain rule method and the natural logarithm integral condition.
A rule of thumb proposed by Herbert Kasube of Bradley University advises that whichever function comes first in the following list should be u:
L - Logarithmic Functions: 
        ln
        ⁡
        (
        x
        )
        ,
          log
            b
        ⁡
        (
        x
        )
        ,
    {\displaystyle \ln(x),\ \log _{b}(x),}
   etc.
I - Inverse trigonometric functions: 
        arctan
        ⁡
        (
        x
        )
        ,
        arcsec
        ⁡
        (
        x
        )
        ,
    {\displaystyle \arctan(x),\ \operatorname {arcsec}(x),}
   etc.
A - Algebraic functions: 
          x
            2
        ,
        3
          x
            50
        ,
    {\displaystyle x^{2},\ 3x^{50},}
   etc.
T - Trigonometric functions: 
        sin
        ⁡
        (
        x
        )
        ,
        tan
        ⁡
        (
        x
        )
        ,
    {\displaystyle \sin(x),\ \tan(x),}
   etc.
E - Exponential functions: 
          e
            x
        ,
          19
            x
        ,
    {\displaystyle e^{x},\ 19^{x},}
   etc.
The function which is to be dv is whichever comes last in the list: functions lower on the list have easier antiderivatives than the functions above them. The rule is sometimes written as "DETAIL" where D stands for dv.
To demonstrate the LIATE rule, consider the integral
        ∫
        x
        ⋅
        cos
        ⁡
        (
        x
        )
        d
        x
        .
    {\displaystyle \int x\cdot \cos(x)\ dx\ .}
Following the LIATE rule, u = x and dv = cos(x)dx, hence du = dx and v = sin(x), which makes the integral become
        x
        ⋅
        sin
        ⁡
        (
        x
        )
        −
        ∫
        1
        sin
        ⁡
        (
        x
        )
        d
        x
    {\displaystyle x\cdot \sin(x)-\int 1\sin(x)\ dx}
which equals
        x
        ⋅
        sin
        ⁡
        (
        x
        )
        +
        cos
        ⁡
        (
        x
        )
        +
        C
        .
    {\displaystyle x\cdot \sin(x)+\cos(x)+C\ .}
In general, one tries to choose u and dv such that du is simpler than u and dv is easy to integrate. If instead cos(x) was chosen as u, and x.dx as dv, we would have the integral
              x
                2
            2
        cos
        ⁡
        (
        x
        )
        +
        ∫
              x
                2
            2
        sin
        ⁡
        (
        x
        )
        d
        x
        ,
    {\displaystyle {\frac {x^{2}}{2}}\cos(x)+\int {\frac {x^{2}}{2}}\sin(x)\ dx\ ,}
which, after recursive application of the integration by parts formula, would clearly result in an infinite recursion and lead nowhere.
Although a useful rule of thumb, there are exceptions to the LIATE rule. A common alternative is to consider the rules in the "ILATE" order instead. Also, in some cases, polynomial terms need to be split in non-trivial ways. For example, to integrate
        ∫
          x
            3
          e
              x
                2
        d
        x
        ,
    {\displaystyle \int x^{3}e^{x^{2}}\ dx\ ,}
one would set
        u
        =
          x
            2
        ,
        d
        v
        =
        x
        ⋅
          e
              x
                2
        d
        x
        ,
    {\displaystyle u=x^{2},\quad dv=x\cdot e^{x^{2}}\ dx\ ,}
so that
        d
        u
        =
        2
        x
        d
        x
        ,
        v
        =
              e
                  x
                    2
            2
        .
    {\displaystyle du=2x\ dx,\quad v={\frac {e^{x^{2}}}{2}}\ .}
Then
        ∫
          x
            3
          e
              x
                2
        d
        x
        =
        ∫
          (
            x
              2
          )
          (
          x
            e
                x
                  2
          )
        d
        x
        =
        ∫
        u
        d
        v
        =
        u
        v
        −
        ∫
        v
        d
        u
        =
                x
                  2
                e
                    x
                      2
            2
        −
        ∫
        x
          e
              x
                2
        d
        x
        .
    {\displaystyle \int x^{3}e^{x^{2}}\ dx=\int \left(x^{2}\right)\left(xe^{x^{2}}\right)\ dx=\int u\ dv=uv-\int v\ du={\frac {x^{2}e^{x^{2}}}{2}}-\int xe^{x^{2}}\ dx\ .}
Finally, this results in
        ∫
          x
            3
          e
              x
                2
        d
        x
        =
                e
                    x
                      2
              (
                x
                  2
              −
              1
              )
            2
        +
        C
        .
    {\displaystyle \int x^{3}e^{x^{2}}\ dx={\frac {e^{x^{2}}(x^{2}-1)}{2}}+C.}
Integration by parts is often used as a tool to prove theorems in mathematical analysis. This section gives a few examples.
The gamma function is an example of a special function, defined as an improper integral. Integration by parts illustrates it to be an extension of the factorial:
                Γ
                (
                z
                )
                =
                  ∫
                    0
                    ∞
                d
                λ
                  e
                    −
                    λ
                  λ
                    z
                    −
                    1
                =
                −
                  ∫
                    0
                    ∞
                d
                  (
                    e
                      −
                      λ
                  )
                  λ
                    z
                    −
                    1
                =
                −
                    [
                      e
                        −
                        λ
                      λ
                        z
                        −
                        1
                    ]
                    0
                    ∞
                +
                  ∫
                    0
                    ∞
                d
                  (
                    λ
                      z
                      −
                      1
                  )
                  e
                    −
                    λ
                =
                0
                +
                  ∫
                    0
                    ∞
                d
                λ
                  (
                  z
                  −
                  1
                  )
                  λ
                    z
                    −
                    2
                  e
                    −
                    λ
                =
                (
                z
                −
                1
                )
                Γ
                (
                z
                −
                1
                )
    {\displaystyle {\begin{aligned}\Gamma (z)&=\int _{0}^{\infty }d\lambda e^{-\lambda }\lambda ^{z-1}\\&=-\int _{0}^{\infty }d\left(e^{-\lambda }\right)\lambda ^{z-1}\\&=-\left[e^{-\lambda }\lambda ^{z-1}\right]_{0}^{\infty }+\int _{0}^{\infty }d\left(\lambda ^{z-1}\right)e^{-\lambda }\\&=0+\int _{0}^{\infty }d\lambda \left(z-1\right)\lambda ^{z-2}e^{-\lambda }\\&=(z-1)\Gamma (z-1)\\\end{aligned}}}
yielding the famous identity
        Γ
        (
        z
        )
        =
        (
        z
        −
        1
        )
        Γ
        (
        z
        −
        1
        )
        .
    {\displaystyle \Gamma (z)=(z-1)\Gamma (z-1)\,.}
Since
        Γ
        (
        1
        )
        =
          ∫
            0
            ∞
        d
        λ
          e
            −
            λ
        =
        1
    {\displaystyle \Gamma (1)=\int _{0}^{\infty }d\lambda e^{-\lambda }=1}
  ,
for integer z, applying this formula repeatedly gives the factorial (denoted by the !):
        Γ
        (
        z
        +
        1
        )
        =
        z
        !
    {\displaystyle \Gamma (z+1)=z!}
Integration by parts is often used in harmonic analysis, particularly Fourier analysis, to show that quickly oscillating integrals with sufficiently smooth integrands decay quickly. The most common example of this is its use in showing that the decay of function's Fourier transform depends on the smoothness of that function, as described below.
Fourier transform of derivative
If f is a k-times continuously differentiable function and all derivatives up to the kth one decay to zero at infinity, then its Fourier transform satisfies
        (
            F
          f
            (
            k
            )
        )
        (
        ξ
        )
        =
        (
        2
        π
        i
        ξ
          )
            k
            F
        f
        (
        ξ
        )
        ,
    {\displaystyle ({\mathcal {F}}f^{(k)})(\xi )=(2\pi i\xi )^{k}{\mathcal {F}}f(\xi ),}
where f(k) is the kth derivative of f. (The exact constant on the right depends on the convention of the Fourier transform used.) This is proved by noting that
            d
              d
              y
          e
            −
            2
            π
            i
            y
            ξ
        =
        −
        2
        π
        i
        ξ
          e
            −
            2
            π
            i
            y
            ξ
        ,
    {\displaystyle {\frac {d}{dy}}e^{-2\pi iy\xi }=-2\pi i\xi e^{-2\pi iy\xi },}
so using integration by parts on the Fourier transform of the derivative we get
                (
                    F
                  f
                  ′
                )
                (
                ξ
                )
                =
                  ∫
                    −
                    ∞
                    ∞
                  e
                    −
                    2
                    π
                    i
                    y
                    ξ
                  f
                  ′
                (
                y
                )
                d
                y
                =
                    [
                      e
                        −
                        2
                        π
                        i
                        y
                        ξ
                    f
                    (
                    y
                    )
                    ]
                    −
                    ∞
                    ∞
                −
                  ∫
                    −
                    ∞
                    ∞
                (
                −
                2
                π
                i
                ξ
                  e
                    −
                    2
                    π
                    i
                    y
                    ξ
                )
                f
                (
                y
                )
                d
                y
                =
                2
                π
                i
                ξ
                  ∫
                    −
                    ∞
                    ∞
                  e
                    −
                    2
                    π
                    i
                    y
                    ξ
                f
                (
                y
                )
                d
                y
                =
                2
                π
                i
                ξ
                    F
                f
                (
                ξ
                )
                .
    {\displaystyle {\begin{aligned}({\mathcal {F}}f')(\xi )&=\int _{-\infty }^{\infty }e^{-2\pi iy\xi }f'(y)\,dy\\&=\left[e^{-2\pi iy\xi }f(y)\right]_{-\infty }^{\infty }-\int _{-\infty }^{\infty }(-2\pi i\xi e^{-2\pi iy\xi })f(y)\,dy\\&=2\pi i\xi \int _{-\infty }^{\infty }e^{-2\pi iy\xi }f(y)\,dy\\&=2\pi i\xi {\mathcal {F}}f(\xi ).\end{aligned}}}
Applying this inductively gives the result for general k. A similar method can be used to find the Laplace transform of a derivative of a function.
Decay of Fourier transform
The above result tells us about the decay of the Fourier transform, since it follows that if f and f(k) are integrable then
        |
            F
        f
        (
        ξ
        )
        |
        ≤
              I
              (
              f
              )
              1
              +
              |
              2
              π
              ξ
                |
                  k
    {\displaystyle \vert {\mathcal {F}}f(\xi )\vert \leq {\frac {I(f)}{1+\vert 2\pi \xi \vert ^{k}}}}
  , where 
        I
        (
        f
        )
        =
          ∫
            −
            ∞
            ∞
            (
        |
        f
        (
        y
        )
        |
        +
        |
          f
            (
            k
            )
        (
        y
        )
        |
            )
        d
        y
    {\displaystyle I(f)=\int _{-\infty }^{\infty }{\Bigl (}\vert f(y)\vert +\vert f^{(k)}(y)\vert {\Bigr )}dy}
  .
In other words, if f satisfies these conditions then its Fourier transform decays at infinity at least as quickly as 1/|ξ|k. In particular, if k ≥ 2 then the Fourier transform is integrable.
The proof uses the fact, which is immediate from the definition of the Fourier transform, that
        |
            F
        f
        (
        ξ
        )
        |
        ≤
          ∫
            −
            ∞
            ∞
        |
        f
        (
        y
        )
        |
        d
        y
        .
    {\displaystyle \vert {\mathcal {F}}f(\xi )\vert \leq \int _{-\infty }^{\infty }\vert f(y)\vert \,dy.}
Using the same idea on the equality stated at the start of this subsection gives
        |
        (
        2
        π
        i
        ξ
          )
            k
            F
        f
        (
        ξ
        )
        |
        ≤
          ∫
            −
            ∞
            ∞
        |
          f
            (
            k
            )
        (
        y
        )
        |
        d
        y
        .
    {\displaystyle \vert (2\pi i\xi )^{k}{\mathcal {F}}f(\xi )\vert \leq \int _{-\infty }^{\infty }\vert f^{(k)}(y)\vert \,dy.}
Summing these two inequalities and then dividing by 1 + |2πξk| gives the stated inequality.
One use of integration by parts in operator theory is that it shows that the -∆ (where ∆ is the Laplace operator) is a positive operator on L2 (see Lp space). If f is smooth and compactly supported then, using integration by parts, we have
                ⟨
                −
                Δ
                f
                ,
                f
                  ⟩
                      L
                        2
                =
                −
                  ∫
                    −
                    ∞
                    ∞
                  f
                  ″
                (
                x
                )
                      f
                      (
                      x
                      )
                    ¯
                d
                x
                =
                −
                    [
                      f
                      ′
                    (
                    x
                    )
                          f
                          (
                          x
                          )
                        ¯
                    ]
                    −
                    ∞
                    ∞
                +
                  ∫
                    −
                    ∞
                    ∞
                  f
                  ′
                (
                x
                )
                        f
                        ′
                      (
                      x
                      )
                    ¯
                d
                x
                =
                  ∫
                    −
                    ∞
                    ∞
                |
                  f
                  ′
                (
                x
                )
                  |
                    2
                d
                x
                ≥
                0.
    {\displaystyle {\begin{aligned}\langle -\Delta f,f\rangle _{L^{2}}&=-\int _{-\infty }^{\infty }f''(x){\overline {f(x)}}\,dx\\&=-\left[f'(x){\overline {f(x)}}\right]_{-\infty }^{\infty }+\int _{-\infty }^{\infty }f'(x){\overline {f'(x)}}\,dx\\&=\int _{-\infty }^{\infty }\vert f'(x)\vert ^{2}\,dx\geq 0.\end{aligned}}}
For determining boundary conditions in Sturm–Liouville theory
Deriving the Euler–Lagrange equation in the calculus of variations
Integration by parts can often be applied recursively to provide the following formula
        ∫
          u
            (
            n
            )
        v
        =
          u
            (
            n
            −
            1
            )
        v
        −
          u
            (
            n
            −
            2
            )
          v
          ′
        +
          u
            (
            n
            −
            3
            )
          v
          ″
        −
        ⋯
        +
        (
        −
        1
          )
            n
            −
            1
        u
          v
            (
            n
            −
            1
            )
        +
        (
        −
        1
          )
            n
        ∫
        u
          v
            (
            n
            )
        .
    {\displaystyle \int u^{(n)}v=u^{(n-1)}v-u^{(n-2)}v'+u^{(n-3)}v''-\cdots +(-1)^{n-1}uv^{(n-1)}+(-1)^{n}\int uv^{(n)}.}
This form is especially useful when v(n) becomes zero for some n (and, in particular, when v is a polynomial function with degree smaller than n). Hence, the integral evaluation can stop once the v(n − 1) term has been reached.
While the aforementioned recursive definition is correct, it is often tedious to remember and implement. A much easier visual representation of this process is often taught to students and is dubbed either "the tabular method", "the Stand and Deliver method", "rapid repeated integration" or "the tic-tac-toe method". This method works best when one of the two functions in the product is a polynomial, that is, after differentiating it several times one obtains zero. It may also be extended to work for evaluating Laplace transform.
For example, consider the integral
        ∫
          x
            3
        cos
        ⁡
        x
        d
        x
        .
    {\displaystyle \int x^{3}\cos x\,dx.\!}
Let u = x3. Begin with this function and list in a column all the subsequent derivatives until zero is reached. Secondly, begin with the function v (in this case cos(x)) and list each integral of v until the size of the column is the same as that of u. The result should appear as follows.
Now simply pair the 1st entry of column A with the 2nd entry of column B, the 2nd entry of column A with the 3rd entry of column B, etc... with alternating signs (beginning with the positive sign). Do so until further pairing leads to sums of zeros. The result is the following (notice the alternating signs in each term):
        (
        +
        )
        (
          x
            3
        )
        (
        sin
        ⁡
        x
        )
        −
        (
        3
          x
            2
        )
        (
        −
        cos
        ⁡
        x
        )
        +
        (
        6
        x
        )
        (
        −
        sin
        ⁡
        x
        )
        −
        (
        6
        )
        (
        cos
        ⁡
        x
        )
        +
        C
        .
    {\displaystyle (+)(x^{3})(\sin x)-(3x^{2})(-\cos x)+(6x)(-\sin x)-(6)(\cos x)+C\,.}
Which, with simplification, leads to the result
          x
            3
        sin
        ⁡
        x
        +
        3
          x
            2
        cos
        ⁡
        x
        −
        6
        x
        sin
        ⁡
        x
        −
        6
        cos
        ⁡
        x
        +
        C
        .
    {\displaystyle x^{3}\sin x+3x^{2}\cos x-6x\sin x-6\cos x+C.\,}
With proper understanding of the tabular method, it can be extended. Consider
        ∫
          e
            x
        cos
        ⁡
        x
        d
        x
        .
    {\displaystyle \int e^{x}\cos x\,dx.}
In this case in the last step it is necessary to integrate the product of the two bottom cells obtaining:
        ∫
          e
            x
        cos
        ⁡
        x
        d
        x
        =
          e
            x
        sin
        ⁡
        x
        +
          e
            x
        cos
        ⁡
        x
        −
        ∫
          e
            x
        cos
        ⁡
        x
        d
        x
        ,
    {\displaystyle \int e^{x}\cos x\,dx=e^{x}\sin x+e^{x}\cos x-\int e^{x}\cos x\,dx,}
which leads to
        2
        ∫
          e
            x
        cos
        ⁡
        x
        d
        x
        =
          e
            x
        sin
        ⁡
        x
        +
          e
            x
        cos
        ⁡
        x
        ,
    {\displaystyle 2\,\int e^{x}\cos x\,dx=e^{x}\sin x+e^{x}\cos x,}
and yields the result:
        ∫
          e
            x
        cos
        ⁡
        x
        d
        x
        =
                e
                  x
              (
              sin
              ⁡
              x
              +
              cos
              ⁡
              x
              )
            2
        +
        C
        .
    {\displaystyle \int e^{x}\cos x\,dx={e^{x}(\sin x+\cos x) \over 2}+C.\!}
The formula for integration by parts can be extended to functions of several variables. Instead of an interval one needs to integrate over an n-dimensional set. Also, one replaces the derivative with a partial derivative.
          ∫
            Ω
        φ
        div
              v
              →
          d
        V
        =
          ∫
            ∂
            Ω
        φ
              v
              →
        ⋅
          d
              S
              →
        −
          ∫
            Ω
              v
              →
        ⋅
        grad
        φ
          d
        V
    {\displaystyle \int _{\Omega }\varphi \,\operatorname {div} \,{\vec {v}}\;\mathrm {d} V=\int _{\partial \Omega }\varphi \,{\vec {v}}\cdot \mathrm {d} {\vec {S}}-\int _{\Omega }{\vec {v}}\cdot \operatorname {grad} \,\varphi \;\mathrm {d} V}
  .
More specifically, suppose Ω is an open bounded subset of ℝn with a piecewise smooth boundary Γ. If u and v are two continuously differentiable functions on the closure of Ω, then the formula for integration by parts is
          ∫
            Ω
              ∂
              u
              ∂
                x
                  i
        v
        d
        Ω
        =
          ∫
            Γ
        u
        v
                ν
                ^
            i
        d
        Γ
        −
          ∫
            Ω
        u
              ∂
              v
              ∂
                x
                  i
        d
        Ω
        ,
    {\displaystyle \int _{\Omega }{\frac {\partial u}{\partial x_{i}}}v\,d\Omega =\int _{\Gamma }uv\,{\hat {\nu }}_{i}\,d\Gamma -\int _{\Omega }u{\frac {\partial v}{\partial x_{i}}}\,d\Omega ,}
where 
                ν
              ^
    {\displaystyle {\hat {\mathbf {\nu } }}}
   is the outward unit surface normal to Γ, 
                ν
                ^
            i
    {\displaystyle {\hat {\nu }}_{i}}
   is its i-th component, and i ranges from 1 to n.
Replacing v in the above formula with vi and summing over i gives the vector formula
          ∫
            Ω
        ∇
        u
        ⋅
          v
        d
        Ω
        =
          ∫
            Γ
        u
        (
          v
        ⋅
              ν
              ^
        )
        d
        Γ
        −
          ∫
            Ω
        u
        ∇
        ⋅
          v
        d
        Ω
        ,
    {\displaystyle \int _{\Omega }\nabla u\cdot \mathbf {v} \,d\Omega =\int _{\Gamma }u(\mathbf {v} \cdot {\hat {\nu }})\,d\Gamma -\int _{\Omega }u\,\nabla \cdot \mathbf {v} \,d\Omega ,}
where v is a vector-valued function with components v1, ..., vn.
Setting u equal to the constant function 1 in the above formula gives the divergence theorem
          ∫
            Γ
          v
        ⋅
              ν
              ^
        d
        Γ
        =
          ∫
            Ω
        ∇
        ⋅
          v
        d
        Ω
        .
    {\displaystyle \int _{\Gamma }\mathbf {v} \cdot {\hat {\nu }}\,d\Gamma =\int _{\Omega }\nabla \cdot \mathbf {v} \,d\Omega .}
For 
          v
        =
        ∇
        v
    {\displaystyle \mathbf {v} =\nabla v}
   where 
        v
        ∈
          C
            2
        (
              Ω
              ¯
        )
    {\displaystyle v\in C^{2}({\bar {\Omega }})}
  , one gets
          ∫
            Ω
        ∇
        u
        ⋅
        ∇
        v
        d
        Ω
        =
          ∫
            Γ
        u
        ∇
        v
        ⋅
              ν
              ^
        d
        Γ
        −
          ∫
            Ω
        u
          ∇
            2
        v
        d
        Ω
        ,
    {\displaystyle \int _{\Omega }\nabla u\cdot \nabla v\,d\Omega =\int _{\Gamma }u\,\nabla v\cdot {\hat {\nu }}\,d\Gamma -\int _{\Omega }u\,\nabla ^{2}v\,d\Omega ,}
which is the first Green's identity.
The regularity requirements of the theorem can be relaxed. For instance, the boundary Γ need only be Lipschitz continuous. In the first formula above, only u, v ∈ H1(Ω) is necessary (where H1 is a Sobolev space); the other formulas have similarly relaxed requirements.
Integration by parts for the Lebesgue–Stieltjes integral
Integration by parts for semimartingales, involving their quadratic covariation.
Integration by substitution
Legendre transformation
